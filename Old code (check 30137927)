{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# About This Assignment"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Design and implement a complete **Natural Language Processing (NLP)** pipeline for\n",
    "advanced sequence-to-sequence tasks using the Sherlock Holmes dataset, including:\n",
    "-  text summarisation\n",
    "- semantic search\n",
    "- thematic analysis \n",
    "\n",
    "The focus is on understanding the process, implementing modular steps, and critically evaluating outcomes.\n",
    "\n",
    "**Objective** \n",
    "\n",
    "To write a comprehensive report detailing the development, findings, and\n",
    "results of your (NLP) pipeline, focusing on:\n",
    "- How design choices influenced performance.\n",
    "- Challenges encountered at each stage.\n",
    "- Insights gained from the dataset and NLP methods used.\n",
    "- Suggest improvements for each component of the pipeline.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# About this Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- This collection features all the stories and novels of Sherlock Holmes by Arthur Conan Doyle. \n",
    "- Within the Sherlock folder, you'll find multiple .txt files, each containing a unique story."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Importing neccesary libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import re\n",
    "import nltk "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Importing the dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As the dataset is presented as a folder containing each story individually in a txt file, we have to save each story in a dictionary to be able to handle them easily. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "\n",
      "\n",
      "\n",
      "                      THE ADVENTURE OF THE THREE GARRIDEBS\n",
      "\n",
      "                               Arthur Conan Doyle\n",
      "\n",
      "\n",
      "\n",
      "     It may have been a comedy, or it may have been a tragedy. It cost one\n",
      "     man his reason, it cost me a blood-letting, and it cost yet another\n",
      "     man the penalties of the law. Yet there was certainly an element of\n",
      "     comedy. Well, you shall judge for yourselves.\n",
      "\n",
      "     I remember the date very well, for it was in the same month that\n",
      "     Holmes refused a knighthood for services which may perhaps some day\n",
      "     be described. I only refer to the matter in passing, for in my\n",
      "     position of partner and confidant I am obliged to be particularly\n",
      "     careful to avoid any indiscretion. I repeat, however, that this\n",
      "     enables me to fix the date, which was the latter end of June, 1902,\n",
      "     shortly after the conclusion of the South African War. Holmes had\n",
      "     spent several days in bed, as was his habit from time to time, but he\n",
      "     emerged that morning with a long foolscap document in his hand and a\n",
      "     twinkle of amusement in his austere gray eyes.\n",
      "\n",
      "     \"There is a chance for you to make some money, friend Watson,\" said\n",
      "     he. \"Have you ever heard the name of Garrideb?\"\n",
      "\n",
      "     I admitted that I had not.\n",
      "\n",
      "     \"Well, if you can lay your hand upon a Garrideb, there's money in\n",
      "     it.\"\n",
      "\n",
      "     \"Why?\"\n",
      "\n",
      "     \"Ah, that's a long story--rather a whimsical one, too. I don't think\n",
      "     in all our explorations of human complexities we have ever come upon\n",
      "     anything more singular. The fellow will be here presently for\n",
      "     cross-examination, so I won't open the matter up till he comes. But,\n",
      "     meanwhile, that's the name we want.\"\n",
      "\n",
      "     The telephone directory lay on the table beside me, and I turned over\n",
      "     the pages in a rather hopeless quest. But to my amazement there was\n",
      "     this strange name in its due place. I gave a cry of triumph.\n",
      "\n",
      "     \"Here you are, Holmes! Here it is!\"\n",
      "\n",
      "     Holmes took the book from my hand.\n",
      "\n",
      "     \"'Garrideb, N.,' \" he read, \"'136 Little Ryder Street, W.' Sorry to\n",
      "     disappoint you, my dear Watson, but this is the man himself. That is\n",
      "     the address upon his letter. We want another to match him.\"\n",
      "\n",
      "     Mrs. Hudson had come in with a card upon a tray. I took it up and\n",
      "     glanced at it.\n",
      "\n",
      "     \"Why, here it is!\" I cried in amazement. \"This is a different\n",
      "     initial. John Garrideb, Counsellor at Law, Moorville, Kansas, U. S.\n",
      "     A.\"\n",
      "\n",
      "     Holmes smiled as he looked at the card. \"I am afraid you must make\n",
      "     yet another effort, Watson,\" said he. \"This gentleman is also in the\n",
      "     plot already, though I certainly did not expect to see him this\n",
      "     morning. However, he is in a position to tell us a good deal which I\n",
      "     want to know.\"\n",
      "\n",
      "     A moment later he was in the room. Mr. John Garrideb, Counsellor at\n",
      "     Law, was a short, powerful man with the round, fresh, clean-shaven\n",
      "     face characteristic of so many American men of affairs. The general\n",
      "     effect was chubby and rather childlike, so that one received the\n",
      "     impression of quite a young man with a broad set smile upon his face.\n",
      "     His eyes, however, were arresting. Seldom in any human head have I\n",
      "     seen a pair which bespoke a more intense inward life, so bright were\n",
      "     they, so alert, so responsive to every change of thought. His accent\n",
      "     was American, but was not accompanied by any eccentricity of speech.\n",
      "\n",
      "     \"Mr. Holmes?\" he asked, glancing from one to the other. \"Ah, yes!\n",
      "     Your pictures are not unlike you, sir, if I may say so. I believe you\n",
      "     have had a letter from my namesake, Mr. Nathan Garrideb, have you\n",
      "     not?\"\n",
      "\n",
      "     \"Pray sit down,\" said Sherlock Holmes. \"We shall, I fancy, have a\n",
      "     good deal to discuss.\" He took up his sheets of foolscap. \"You are,\n",
      "     of course, the Mr. John Garrideb mentioned in this document. But\n",
      "     surely you have been in England some time?\"\n",
      "\n",
      "     \"Why do you say that, Mr. Holmes?\" I seemed to read sudden suspicion\n",
      "     in those expressive eyes.\n",
      "\n",
      "     \"Your whole outfit is English.\"\n",
      "\n",
      "     Mr. Garrideb forced a laugh. \"I've read of your tricks, Mr. Holmes,\n",
      "     but I never thought I would be the subject of them. Where do you read\n",
      "     that?\"\n",
      "\n",
      "     \"The shoulder cut of your coat, the toes of your boots--could anyone\n",
      "     doubt it?\"\n",
      "\n",
      "     \"Well, well, I had no idea I was so obvious a Britisher. But business\n",
      "     brought me over here some time ago, and so, as you say, my outfit is\n",
      "     nearly all London. However, I guess your time is of value, and we did\n",
      "     not meet to talk about the cut of my socks. What about getting down\n",
      "     to that paper you hold in your hand?\"\n",
      "\n",
      "     Holmes had in some way ruffled our visitor, whose chubby face had\n",
      "     assumed a far less amiable expression.\n",
      "\n",
      "     \"Patience! Patience, Mr. Garrideb!\" said my friend in a soothing\n",
      "     voice. \"Dr. Watson would tell you that these little digressions of\n",
      "     mine sometimes prove in the end to have some bearing on the matter.\n",
      "     But why did Mr. Nathan Garrideb not come with you?\"\n",
      "\n",
      "     \"Why did he ever drag you into it at all?\" asked our visitor with a\n",
      "     sudden outflame of anger. \"What in thunder had you to do with it?\n",
      "     Here was a bit of professional business between two gentlemen, and\n",
      "     one of them must needs call in a detective! I saw him this morning,\n",
      "     and he told me this fool-trick he had played me, and that's why I am\n",
      "     here. But I feel bad about it, all the same.\"\n",
      "\n",
      "     \"There was no reflection upon you, Mr. Garrideb. It was simply zeal\n",
      "     upon his part to gain your end--an end which is, I understand,\n",
      "     equally vital for both of you. He knew that I had means of getting\n",
      "     information, and, therefore, it was very natural that he should apply\n",
      "     to me.\"\n",
      "\n",
      "     Our visitor's angry face gradually cleared.\n",
      "\n",
      "     \"Well, that puts it different,\" said he. \"When I went to see him this\n",
      "     morning and he told me he had sent to a detective, I just asked for\n",
      "     your address and came right away. I don't want police butting into a\n",
      "     private matter. But if you are content just to help us find the man,\n",
      "     there can be no harm in that.\"\n",
      "\n",
      "     \"Well, that is just how it stands,\" said Holmes. \"And now, sir, since\n",
      "     you are here, we had best have a clear account from your own lips. My\n",
      "     friend here knows nothing of the details.\"\n",
      "\n",
      "     Mr. Garrideb surveyed me with not too friendly a gaze.\n",
      "\n",
      "     \"Need he know?\" he asked.\n",
      "\n",
      "     \"We usually work together.\"\n",
      "\n",
      "     \"Well, there's no reason it should be kept a secret. I'll give you\n",
      "     the facts as short as I can make them. If you came from Kansas I\n",
      "     would not need to explain to you who Alexander Hamilton Garrideb was.\n",
      "     He made his money in real estate, and afterwards in the wheat pit at\n",
      "     Chicago, but he spent it in buying up as much land as would make one\n",
      "     of your counties, lying along the Arkansas River, west of Fort Dodge.\n",
      "     It's grazing-land and lumber-land and arable-land and\n",
      "     mineralized-land, and just every sort of land that brings dollars to\n",
      "     the man that owns it.\n",
      "\n",
      "     \"He had no kith nor kin--or, if he had, I never heard of it. But he\n",
      "     took a kind of pride in the queerness of his name. That was what\n",
      "     brought us together. I was in the law at Topeka, and one day I had a\n",
      "     visit from the old man, and he was tickled to death to meet another\n",
      "     man with his own name. It was his pet fad, and he was dead set to\n",
      "     find out if there were any more Garridebs in the world. 'Find me\n",
      "     another!' said he. I told him I was a busy man and could not spend my\n",
      "     life hiking round the world in search of Garridebs. 'None the less,'\n",
      "     said he, 'that is just what you will do if things pan out as I\n",
      "     planned them.' I thought he was joking, but there was a powerful lot\n",
      "     of meaning in the words, as I was soon to discover.\n",
      "\n",
      "     \"For he died within a year of saying them, and he left a will behind\n",
      "     him. It was the queerest will that has ever been filed in the State\n",
      "     of Kansas. His property was divided into three parts, and I was to\n",
      "     have one on condition that I found two Garridebs who would share the\n",
      "     remainder. It's five million dollars for each if it is a cent, but we\n",
      "     can't lay a finger on it until we all three stand in a row.\n",
      "\n",
      "     \"It was so big a chance that I just let my legal practice slide and I\n",
      "     set forth looking for Garridebs. There is not one in the United\n",
      "     States. I went through it, sir, with a fine-toothed comb and never a\n",
      "     Garrideb could I catch. Then I tried the old country. Sure enough\n",
      "     there was the name in the London telephone directory. I went after\n",
      "     him two days ago and explained the whole matter to him. But he is a\n",
      "     lone man, like myself, with some women relations, but no men. It says\n",
      "     three adult men in the will. So you see we still have a vacancy, and\n",
      "     if you can help to fill it we will be very ready to pay your\n",
      "     charges.\"\n",
      "\n",
      "     \"Well, Watson,\" said Holmes with a smile, \"I said it was rather\n",
      "     whimsical, did I not? I should have thought, sir, that your obvious\n",
      "     way was to advertise in the agony columns of the papers.\"\n",
      "\n",
      "     \"I have done that, Mr. Holmes. No replies.\"\n",
      "\n",
      "     \"Dear me! Well, it is certainly a most curious little problem. I may\n",
      "     take a glance at it in my leisure. By the way, it is curious that you\n",
      "     should have come from Topeka. I used to have a correspondent--he is\n",
      "     dead now--old Dr. Lysander Starr, who was mayor in 1890.\"\n",
      "\n",
      "     \"Good old Dr. Starr!\" said our visitor. \"His name is still honoured.\n",
      "     Well, Mr. Holmes, I suppose all we can do is to report to you and let\n",
      "     you know how we progress. I reckon you will hear within a day or\n",
      "     two.\" With this assurance our American bowed and departed.\n",
      "\n",
      "     Holmes had lit his pipe, and he sat for some time with a curious\n",
      "     smile upon his face.\n",
      "\n",
      "     \"Well?\" I asked at last.\n",
      "\n",
      "     \"I am wondering, Watson--just wondering!\"\n",
      "\n",
      "     \"At what?\"\n",
      "\n",
      "     Holmes took his pipe from his lips.\n",
      "\n",
      "     \"I was wondering, Watson, what on earth could be the object of this\n",
      "     man in telling us such a rigmarole of lies. I nearly asked him\n",
      "     so--for there are times when a brutal frontal attack is the best\n",
      "     policy--but I judged it better to let him think he had fooled us.\n",
      "     Here is a man with an English coat frayed at the elbow and trousers\n",
      "     bagged at the knee with a year's wear, and yet by this document and\n",
      "     by his own account he is a provincial American lately landed in\n",
      "     London. There have been no advertisements in the agony columns. You\n",
      "     know that I miss nothing there. They are my favourite covert for\n",
      "     putting up a bird, and I would never have overlooked such a cock\n",
      "     pheasant as that. I never knew a Dr. Lysander Starr, of Topeka. Touch\n",
      "     him where you would he was false. I think the fellow is really an\n",
      "     American, but he has worn his accent smooth with years of London.\n",
      "     What is his game, then, and what motive lies behind this preposterous\n",
      "     search for Garridebs? It's worth our attention, for, granting that\n",
      "     the man is a rascal, he is certainly a complex and ingenious one. We\n",
      "     must now find out if our other correspondent is a fraud also. Just\n",
      "     ring him up, Watson.\"\n",
      "\n",
      "     I did so, and heard a thin, quavering voice at the other end of the\n",
      "     line.\n",
      "\n",
      "     \"Yes, yes, I am Mr. Nathan Garrideb. Is Mr. Holmes there? I should\n",
      "     very much like to have a word with Mr. Holmes.\"\n",
      "\n",
      "     My friend took the instrument and I heard the usual syncopated\n",
      "     dialogue.\n",
      "\n",
      "     \"Yes, he has been here. I understand that you don't know him. ... How\n",
      "     long? ... Only two days! ... Yes, yes, of course, it is a most\n",
      "     captivating prospect. Will you be at home this evening? I suppose\n",
      "     your namesake will not be there? ... Very good, we will come then,\n",
      "     for I would rather have a chat without him. ... Dr. Watson will come\n",
      "     with me. ... I understand from your note that you did not go out\n",
      "     often. ... Well, we shall be round about six. You need not mention it\n",
      "     to the American lawyer. ... Very good. Good-bye!\"\n",
      "\n",
      "     It was twilight of a lovely spring evening, and even Little Ryder\n",
      "     Street, one of the smaller offshoots from the Edgware Road, within a\n",
      "     stone-cast of old Tyburn Tree of evil memory, looked golden and\n",
      "     wonderful in the slanting rays of the setting sun. The particular\n",
      "     house to which we were directed was a large, old-fashioned, Early\n",
      "     Georgian edifice, with a flat brick face broken only by two deep bay\n",
      "     windows on the ground floor. It was on this ground floor that our\n",
      "     client lived, and, indeed, the low windows proved to be the front of\n",
      "     the huge room in which he spent his waking hours. Holmes pointed as\n",
      "     we passed to the small brass plate which bore the curious name.\n",
      "\n",
      "     \"Up some years, Watson,\" he remarked, indicating its discoloured\n",
      "     surface. \"It's his real name, anyhow, and that is something to note.\"\n",
      "\n",
      "     The house had a common stair, and there were a number of names\n",
      "     painted in the hall, some indicating offices and some private\n",
      "     chambers. It was not a collection of residential flats, but rather\n",
      "     the abode of Bohemian bachelors. Our client opened the door for us\n",
      "     himself and apologized by saying that the woman in charge left at\n",
      "     four o'clock. Mr. Nathan Garrideb proved to be a very tall,\n",
      "     loose-jointed, round-backed person, gaunt and bald, some sixty-odd\n",
      "     years of age. He had a cadaverous face, with the dull dead skin of a\n",
      "     man to whom exercise was unknown. Large round spectacles and a small\n",
      "     projecting goat's beard combined with his stooping attitude to give\n",
      "     him an expression of peering curiosity. The general effect, however,\n",
      "     was amiable, though eccentric.\n",
      "\n",
      "     The room was as curious as its occupant. It looked like a small\n",
      "     museum. It was both broad and deep, with cupboards and cabinets all\n",
      "     round, crowded with specimens, geological and anatomical. Cases of\n",
      "     butterflies and moths flanked each side of the entrance. A large\n",
      "     table in the centre was littered with all sorts of debris, while the\n",
      "     tall brass tube of a powerful microscope bristled up among them. As I\n",
      "     glanced round I was surprised at the universality of the man's\n",
      "     interests. Here was a case of ancient coins. There was a cabinet of\n",
      "     flint instruments. Behind his central table was a large cupboard of\n",
      "     fossil bones. Above was a line of plaster skulls with such names as\n",
      "     \"Neanderthal,\" \"Heidelberg,\" \"Cro-Magnon\" printed beneath them. It\n",
      "     was clear that he was a student of many subjects. As he stood in\n",
      "     front of us now, he held a piece of chamois leather in his right hand\n",
      "     with which he was polishing a coin.\n",
      "\n",
      "     \"Syracusan--of the best period,\" he explained, holding it up. \"They\n",
      "     degenerated greatly towards the end. At their best I hold them\n",
      "     supreme, though some prefer the Alexandrian school. You will find a\n",
      "     chair here, Mr. Holmes. Pray allow me to clear these bones. And you,\n",
      "     sir--ah, yes, Dr. Watson--if you would have the goodness to put the\n",
      "     Japanese vase to one side. You see round me my little interests in\n",
      "     life. My doctor lectures me about never going out, but why should I\n",
      "     go out when I have so much to hold me here? I can assure you that the\n",
      "     adequate cataloguing of one of those cabinets would take me three\n",
      "     good months.\"\n",
      "\n",
      "     Holmes looked round him with curiosity.\n",
      "\n",
      "     \"But do you tell me that you never go out?\" he said.\n",
      "\n",
      "     \"Now and again I drive down to Sotheby's or Christie's. Otherwise I\n",
      "     very seldom leave my room. I am not too strong, and my researches are\n",
      "     very absorbing. But you can imagine, Mr. Holmes, what a terrific\n",
      "     shock--pleasant but terrific--it was for me when I heard of this\n",
      "     unparalleled good fortune. It only needs one more Garrideb to\n",
      "     complete the matter, and surely we can find one. I had a brother, but\n",
      "     he is dead, and female relatives are disqualified. But there must\n",
      "     surely be others in the world. I had heard that you handled strange\n",
      "     cases, and that was why I sent to you. Of course, this American\n",
      "     gentleman is quite right, and I should have taken his advice first,\n",
      "     but I acted for the best.\"\n",
      "\n",
      "     \"I think you acted very wisely indeed,\" said Holmes. \"But are you\n",
      "     really anxious to acquire an estate in America?\"\n",
      "\n",
      "     \"Certainly not, sir. Nothing would induce me to leave my collection.\n",
      "     But this gentleman has assured me that he will buy me out as soon as\n",
      "     we have established our claim. Five million dollars was the sum\n",
      "     named. There are a dozen specimens in the market at the present\n",
      "     moment which fill gaps in my collection, and which I am unable to\n",
      "     purchase for want of a few hundred pounds. Just think what I could do\n",
      "     with five million dollars. Why, I have the nucleus of a national\n",
      "     collection. I shall be the Hans Sloane of my age.\"\n",
      "\n",
      "     His eyes gleamed behind his great spectacles. It was very clear that\n",
      "     no pains would be spared by Mr. Nathan Garrideb in finding a\n",
      "     namesake.\n",
      "\n",
      "     \"I merely called to make your acquaintance, and there is no reason\n",
      "     why I should interrupt your studies,\" said Holmes. \"I prefer to\n",
      "     establish personal touch with those with whom I do business. There\n",
      "     are few questions I need ask, for I have your very clear narrative in\n",
      "     my pocket, and I filled up the blanks when this American gentleman\n",
      "     called. I understand that up to this week you were unaware of his\n",
      "     existence.\"\n",
      "\n",
      "     \"That is so. He called last Tuesday.\"\n",
      "\n",
      "     \"Did he tell you of our interview to-day?\"\n",
      "\n",
      "     \"Yes, he came straight back to me. He had been very angry.\"\n",
      "\n",
      "     \"Why should he be angry?\"\n",
      "\n",
      "     \"He seemed to think it was some reflection on his honour. But he was\n",
      "     quite cheerful again when he returned.\"\n",
      "\n",
      "     \"Did he suggest any course of action?\"\n",
      "\n",
      "     \"No, sir, he did not.\"\n",
      "\n",
      "     \"Has he had, or asked for, any money from you?\"\n",
      "\n",
      "     \"No, sir, never!\"\n",
      "\n",
      "     \"You see no possible object he has in view?\"\n",
      "\n",
      "     \"None, except what he states.\"\n",
      "\n",
      "     \"Did you tell him of our telephone appointment?\"\n",
      "\n",
      "     \"Yes, sir, I did.\"\n",
      "\n",
      "     Holmes was lost in thought. I could see that he was puzzled.\n",
      "\n",
      "     \"Have you any articles of great value in your collection?\"\n",
      "\n",
      "     \"No, sir. I am not a rich man. It is a good collection, but not a\n",
      "     very valuable one.\"\n",
      "\n",
      "     \"You have no fear of burglars?\"\n",
      "\n",
      "     \"Not the least.\"\n",
      "\n",
      "     \"How long have you been in these rooms?\"\n",
      "\n",
      "     \"Nearly five years.\"\n",
      "\n",
      "     Holmes's cross-examination was interrupted by an imperative knocking\n",
      "     at the door. No sooner had our client unlatched it than the American\n",
      "     lawyer burst excitedly into the room.\n",
      "\n",
      "     \"Here you are!\" he cried, waving a paper over his head. \"I thought I\n",
      "     should be in time to get you. Mr. Nathan Garrideb, my\n",
      "     congratulations! You are a rich man, sir. Our business is happily\n",
      "     finished and all is well. As to you, Mr. Holmes, we can only say we\n",
      "     are sorry if we have given you any useless trouble.\"\n",
      "\n",
      "     He handed over the paper to our client, who stood staring at a marked\n",
      "     advertisement. Holmes and I leaned forward and read it over his\n",
      "     shoulder. This is how it ran:\n",
      "\n",
      "                                 Howard Garrideb\n",
      "                      Constructor of Agricultural Machinery\n",
      "        Binders, reapers, steam and hand plows, drills, harrows, farmers'\n",
      "                  carts, buckboards, and all other appliances.\n",
      "                          Estimates for Artesian Wells\n",
      "                        Apply Grosvenor Buildings, Aston\n",
      "\n",
      "     \"Glorious!\" gasped our host. \"That makes our third man.\"\n",
      "\n",
      "     \"I had opened up inquiries in Birmingham,\" said the American, \"and my\n",
      "     agent there has sent me this advertisement from a local paper. We\n",
      "     must hustle and put the thing through. I have written to this man and\n",
      "     told him that you will see him in his office to-morrow afternoon at\n",
      "     four o'clock.\"\n",
      "\n",
      "     \"You want me to see him?\"\n",
      "\n",
      "     \"What do you say, Mr. Holmes? Don't you think it would be wiser? Here\n",
      "     am I, a wandering American with a wonderful tale. Why should he\n",
      "     believe what I tell him? But you are a Britisher with solid\n",
      "     references, and he is bound to take notice of what you say. I would\n",
      "     go with you if you wished, but I have a very busy day to-morrow, and\n",
      "     I could always follow you if you are in any trouble.\"\n",
      "\n",
      "     \"Well, I have not made such a journey for years.\"\n",
      "\n",
      "     \"It is nothing, Mr. Garrideb. I have figured out our connections. You\n",
      "     leave at twelve and should be there soon after two. Then you can be\n",
      "     back the same night. All you have to do is to see this man, explain\n",
      "     the matter, and get an affidavit of his existence. By the Lord!\" he\n",
      "     added hotly, \"considering I've come all the way from the centre of\n",
      "     America, it is surely little enough if you go a hundred miles in\n",
      "     order to put this matter through.\"\n",
      "\n",
      "     \"Quite so,\" said Holmes. \"I think what this gentleman says is very\n",
      "     true.\"\n",
      "\n",
      "     Mr. Nathan Garrideb shrugged his shoulders with a disconsolate air.\n",
      "     \"Well, if you insist I shall go,\" said he. \"It is certainly hard for\n",
      "     me to refuse you anything, considering the glory of hope that you\n",
      "     have brought into my life.\"\n",
      "\n",
      "     \"Then that is agreed,\" said Holmes, \"and no doubt you will let me\n",
      "     have a report as soon as you can.\"\n",
      "\n",
      "     \"I'll see to that,\" said the American. \"Well,\" he added, looking at\n",
      "     his watch, \"I'll have to get on. I'll call to-morrow, Mr. Nathan, and\n",
      "     see you off to Birmingham. Coming my way, Mr. Holmes? Well, then,\n",
      "     good-bye, and we may have good news for you to-morrow night.\"\n",
      "\n",
      "     I noticed that my friend's face cleared when the American left the\n",
      "     room, and the look of thoughtful perplexity had vanished.\n",
      "\n",
      "     \"I wish I could look over your collection, Mr. Garrideb,\" said he.\n",
      "     \"In my profession all sorts of odd knowledge comes useful, and this\n",
      "     room of yours is a storehouse of it.\"\n",
      "\n",
      "     Our client shone with pleasure and his eyes gleamed from behind his\n",
      "     big glasses.\n",
      "\n",
      "     \"I had always heard, sir, that you were a very intelligent man,\" said\n",
      "     he. \"I could take you round now if you have the time.\"\n",
      "\n",
      "     \"Unfortunately, I have not. But these specimens are so well labelled\n",
      "     and classified that they hardly need your personal explanation. If I\n",
      "     should be able to look in to-morrow, I presume that there would be no\n",
      "     objection to my glancing over them?\"\n",
      "\n",
      "     \"None at all. You are most welcome. The place will, of course, be\n",
      "     shut up, but Mrs. Saunders is in the basement up to four o'clock and\n",
      "     would let you in with her key.\"\n",
      "\n",
      "     Well, I happen to be clear to-morrow afternoon. If you would say a\n",
      "     word to Mrs. Saunders it would be quite in order. By the way, who is\n",
      "     your house-agent?\"\n",
      "\n",
      "     Our client was amazed at the sudden question.\n",
      "\n",
      "     \"Holloway and Steele, in the Edgware Road. But why?\"\n",
      "\n",
      "     \"I am a bit of an archaeologist myself when it comes to houses,\" said\n",
      "     Holmes, laughing. \"I was wondering if this was Queen Anne or\n",
      "     Georgian.\"\n",
      "\n",
      "     \"Georgian, beyond doubt.\"\n",
      "\n",
      "     \"Really. I should have thought a little earlier. However, it is\n",
      "     easily ascertained. Well, good-bye, Mr. Garrideb, and may you have\n",
      "     every success in your Birmingham journey.\"\n",
      "\n",
      "     The house-agent's was close by, but we found that it was closed for\n",
      "     the day, so we made our way back to Baker Street. It was not till\n",
      "     after dinner that Holmes reverted to the subject.\n",
      "\n",
      "     \"Our little problem draws to a close,\" said he. \"No doubt you have\n",
      "     outlined the solution in your own mind.\"\n",
      "\n",
      "     \"I can make neither head nor tail of it.\"\n",
      "\n",
      "     \"The head is surely clear enough and the tail we should see\n",
      "     to-morrow. Did you notice nothing curious about that advertisement?\"\n",
      "\n",
      "     \"I saw that the word 'plough' was misspelt.\"\n",
      "\n",
      "     \"Oh, you did notice that, did you? Come, Watson, you improve all the\n",
      "     time. Yes, it was bad English but good American. The printer had set\n",
      "     it up as received. Then the buckboards. That is American also. And\n",
      "     artesian wells are commoner with them than with us. It was a typical\n",
      "     American advertisement, but purporting to be from an English firm.\n",
      "     What do you make of that?\"\n",
      "\n",
      "     \"I can only suppose that this American lawyer put it in himself. What\n",
      "     his object was I fail to understand.\"\n",
      "\n",
      "     \"Well, there are alternative explanations. Anyhow, he wanted to get\n",
      "     this good old fossil up to Birmingham. That is very clear. I might\n",
      "     have told him that he was clearly going on a wild-goose chase, but,\n",
      "     on second thoughts, it seemed better to clear the stage by letting\n",
      "     him go. To-morrow, Watson--well, to-morrow will speak for itself.\"\n",
      "\n",
      "     Holmes was up and out early. When he returned at lunchtime I noticed\n",
      "     that his face was very grave.\n",
      "\n",
      "     \"This is a more serious matter than I had expected, Watson,\" said he.\n",
      "     \"It is fair to tell you so, though I know it will only be an\n",
      "     additional reason to you for running your head into danger. I should\n",
      "     know my Watson by now. But there is danger, and you should know it.\"\n",
      "\n",
      "     \"Well, it is not the first we have shared, Holmes. I hope it may not\n",
      "     be the last. What is the particular danger this time?\"\n",
      "\n",
      "     \"We are up against a very hard case. I have identified Mr. John\n",
      "     Garrideb, Counsellor at Law. He is none other than 'Killer' Evans, of\n",
      "     sinister and murderous reputation.\"\n",
      "\n",
      "     \"I fear I am none the wiser.\"\n",
      "\n",
      "     \"Ah, it is not part of your profession to carry about a portable\n",
      "     Newgate Calendar in your memory. I have been down to see friend\n",
      "     Lestrade at the Yard. There may be an occasional want of imaginative\n",
      "     intuition down there, but they lead the world for thoroughness and\n",
      "     method. I had an idea that we might get on the track of our American\n",
      "     friend in their records. Sure enough, I found his chubby face smiling\n",
      "     up at me from the rogues' portrait gallery. 'James Winter, alias\n",
      "     Morecroft, alias Killer Evans,' was the inscription below.\" Holmes\n",
      "     drew an envelope from his pocket. \"I scribbled down a few points from\n",
      "     his dossier: Aged forty-four. Native of Chicago. Known to have shot\n",
      "     three men in the States. Escaped from penitentiary through political\n",
      "     influence. Came to London in 1893. Shot a man over cards in a\n",
      "     night-club in the Waterloo Road in January, 1895. Man died, but he\n",
      "     was shown to have been the aggressor in the row. Dead man was\n",
      "     identified as Rodger Prescott, famous as forger and coiner in\n",
      "     Chicago. Killer Evans released in 1901. Has been under police\n",
      "     supervision since, but so far as known has led an honest life. Very\n",
      "     dangerous man, usually carries arms and is prepared to use them. That\n",
      "     is our bird, Watson--a sporting bird, as you must admit.\"\n",
      "\n",
      "     \"But what is his game?\"\n",
      "\n",
      "     \"Well, it begins to define itself. I have been to the house-agent's.\n",
      "     Our client, as he told us, has been there five years. It was unlet\n",
      "     for a year before then. The previous tenant was a gentleman at large\n",
      "     named Waldron. Waldron's appearance was well remembered at the\n",
      "     office. He had suddenly vanished and nothing more been heard of him.\n",
      "     He was a tall, bearded man with very dark features. Now, Prescott,\n",
      "     the man whom Killer Evans had shot, was, according to Scotland Yard,\n",
      "     a tall, dark man with a beard. As a working hypothesis, I think we\n",
      "     may take it that Prescott, the American criminal, used to live in the\n",
      "     very room which our innocent friend now devotes to his museum. So at\n",
      "     last we get a link, you see.\"\n",
      "\n",
      "     \"And the next link?\"\n",
      "\n",
      "     \"Well, we must go now and look for that.\"\n",
      "\n",
      "     He took a revolver from the drawer and handed it to me.\n",
      "\n",
      "     \"I have my old favourite with me. If our Wild West friend tries to\n",
      "     live up to his nickname, we must be ready for him. I'll give you an\n",
      "     hour for a siesta, Watson, and then I think it will be time for our\n",
      "     Ryder Street adventure.\"\n",
      "\n",
      "     It was just four o'clock when we reached the curious apartment of\n",
      "     Nathan Garrideb. Mrs. Saunders, the caretaker, was about to leave,\n",
      "     but she had no hesitation in admitting us, for the door shut with a\n",
      "     spring lock, and Holmes promised to see that all was safe before we\n",
      "     left. Shortly afterwards the outer door closed, her bonnet passed the\n",
      "     bow window, and we knew that we were alone in the lower floor of the\n",
      "     house. Holmes made a rapid examination of the premises. There was one\n",
      "     cupboard in a dark corner which stood out a little from the wall. It\n",
      "     was behind this that we eventually crouched while Holmes in a whisper\n",
      "     outlined his intentions.\n",
      "\n",
      "     \"He wanted to get our amiable friend out of his room--that is very\n",
      "     clear, and, as the collector never went out, it took some planning to\n",
      "     do it. The whole of this Garrideb invention was apparently for no\n",
      "     other end. I must say, Watson, that there is a certain devilish\n",
      "     ingenuity about it, even if the queer name of the tenant did give him\n",
      "     an opening which he could hardly have expected. He wove his plot with\n",
      "     remarkable cunning.\"\n",
      "\n",
      "     \"But what did he want?\"\n",
      "\n",
      "     \"Well, that is what we are here to find out. It has nothing whatever\n",
      "     to do with our client, so far as I can read the situation. It is\n",
      "     something connected with the man he murdered--the man who may have\n",
      "     been his confederate in crime. There is some guilty secret in the\n",
      "     room. That is how I read it. At first I thought our friend might have\n",
      "     something in his collection more valuable than he knew--something\n",
      "     worth the attention of a big criminal. But the fact that Rodger\n",
      "     Prescott of evil memory inhabited these rooms points to some deeper\n",
      "     reason. Well, Watson, we can but possess our souls in patience and\n",
      "     see what the hour may bring.\"\n",
      "\n",
      "     That hour was not long in striking. We crouched closer in the shadow\n",
      "     as we heard the outer door open and shut. Then came the sharp,\n",
      "     metallic snap of a key, and the American was in the room. He closed\n",
      "     the door softly behind him, took a sharp glance around him to see\n",
      "     that all was safe, threw off his overcoat, and walked up to the\n",
      "     central table with the brisk manner of one who knows exactly what he\n",
      "     has to do and how to do it. He pushed the table to one side, tore up\n",
      "     the square of carpet on which it rested, rolled it completely back,\n",
      "     and then, drawing a jemmy from his inside pocket, he knelt down and\n",
      "     worked vigorously upon the floor. Presently we heard the sound of\n",
      "     sliding boards, and an instant later a square had opened in the\n",
      "     planks. Killer Evans struck a match, lit a stump of candle, and\n",
      "     vanished from our view.\n",
      "\n",
      "     Clearly our moment had come. Holmes touched my wrist as a signal, and\n",
      "     together we stole across to the open trap-door. Gently as we moved,\n",
      "     however, the old floor must have creaked under our feet, for the head\n",
      "     of our American, peering anxiously round, emerged suddenly from the\n",
      "     open space. His face turned upon us with a glare of baffled rage,\n",
      "     which gradually softened into a rather shamefaced grin as he realized\n",
      "     that two pistols were pointed at his head.\n",
      "\n",
      "     \"Well, well!\" said he coolly as he scrambled to the surface. \"I guess\n",
      "     you have been one too many for me, Mr. Holmes. Saw through my game, I\n",
      "     suppose, and played me for a sucker from the first. Well, sir, I hand\n",
      "     it to you; you have me beat and--\"\n",
      "\n",
      "     In an instant he had whisked out a revolver from his breast and had\n",
      "     fired two shots. I felt a sudden hot sear as if a red-hot iron had\n",
      "     been pressed to my thigh. There was a crash as Holmes's pistol came\n",
      "     down on the man's head. I had a vision of him sprawling upon the\n",
      "     floor with blood running down his face while Holmes rummaged him for\n",
      "     weapons. Then my friend's wiry arms were round me, and he was leading\n",
      "     me to a chair.\n",
      "\n",
      "     \"You're not hurt, Watson? For God's sake, say that you are not hurt!\"\n",
      "\n",
      "     It was worth a wound--it was worth many wounds--to know the depth of\n",
      "     loyalty and love which lay behind that cold mask. The clear, hard\n",
      "     eyes were dimmed for a moment, and the firm lips were shaking. For\n",
      "     the one and only time I caught a glimpse of a great heart as well as\n",
      "     of a great brain. All my years of humble but single-minded service\n",
      "     culminated in that moment of revelation.\n",
      "\n",
      "     \"It's nothing, Holmes. It's a mere scratch.\"\n",
      "\n",
      "     He had ripped up my trousers with his pocket-knife.\n",
      "\n",
      "     \"You are right,\" he cried with an immense sigh of relief. \"It is\n",
      "     quite superficial.\" His face set like flint as he glared at our\n",
      "     prisoner, who was sitting up with a dazed face. \"By the Lord, it is\n",
      "     as well for you. If you had killed Watson, you would not have got out\n",
      "     of this room alive. Now, sir, what have you to say for yourself?\"\n",
      "\n",
      "     He had nothing to say for himself. He only sat and scowled. I leaned\n",
      "     on Holmes's arm, and together we looked down into the small cellar\n",
      "     which had been disclosed by the secret flap. It was still illuminated\n",
      "     by the candle which Evans had taken down with him. Our eyes fell upon\n",
      "     a mass of rusted machinery, great rolls of paper, a litter of\n",
      "     bottles, and, neatly arranged upon a small table, a number of neat\n",
      "     little bundles.\n",
      "\n",
      "     \"A printing press--a counterfeiter's outfit,\" said Holmes.\n",
      "\n",
      "     \"Yes, sir,\" said our prisoner, staggering slowly to his feet and then\n",
      "     sinking into the chair. \"The greatest counterfeiter London ever saw.\n",
      "     That's Prescott's machine, and those bundles on the table are two\n",
      "     thousand of Prescott's notes worth a hundred each and fit to pass\n",
      "     anywhere. Help yourselves, gentlemen. Call it a deal and let me beat\n",
      "     it.\"\n",
      "\n",
      "     Holmes laughed.\n",
      "\n",
      "     \"We don't do things like that, Mr. Evans. There is no bolt-hole for\n",
      "     you in this country. You shot this man Prescott, did you not?\"\n",
      "\n",
      "     \"Yes, sir, and got five years for it, though it was he who pulled on\n",
      "     me. Five years--when I should have had a medal the size of a soup\n",
      "     plate. No living man could tell a Prescott from a Bank of England,\n",
      "     and if I hadn't put him out he would have flooded London with them. I\n",
      "     was the only one in the world who knew where he made them. Can you\n",
      "     wonder that I wanted to get to the place? And can you wonder that\n",
      "     when I found this crazy boob of a bug-hunter with the queer name\n",
      "     squatting right on the top of it, and never quitting his room, I had\n",
      "     to do the best I could to shift him? Maybe I would have been wiser if\n",
      "     I had put him away. It would have been easy enough, but I'm a\n",
      "     soft-hearted guy that can't begin shooting unless the other man has a\n",
      "     gun also. But say, Mr. Holmes, what have I done wrong, anyhow? I've\n",
      "     not used this plant. I've not hurt this old stiff. Where do you get\n",
      "     me?\"\n",
      "\n",
      "     \"Only attempted murder, so far as I can see,\" said Holmes. \"But\n",
      "     that's not our job. They take that at the next stage. What we wanted\n",
      "     at present was just your sweet self. Please give the Yard a call,\n",
      "     Watson. It won't be entirely unexpected.\"\n",
      "\n",
      "     So those were the facts about Killer Evans and his remarkable\n",
      "     invention of the three Garridebs. We heard later that our poor old\n",
      "     friend never got over the shock of his dissipated dreams. When his\n",
      "     castle in the air fell down, it buried him beneath the ruins. He was\n",
      "     last heard of at a nursing-home in Brixton. It was a glad day at the\n",
      "     Yard when the Prescott outfit was discovered, for, though they knew\n",
      "     that it existed, they had never been able, after the death of the\n",
      "     man, to find out where it was. Evans had indeed done great service\n",
      "     and caused several worthy C. I. D. men to sleep the sounder, for the\n",
      "     counterfeiter stands in a class by himself as a public danger. They\n",
      "     would willingly have subscribed to that soup-plate medal of which the\n",
      "     criminal had spoken, but an unappreciative bench took a less\n",
      "     favourable view, and the Killer returned to those shades from which\n",
      "     he had just emerged.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "     ----------\n",
      "     This text is provided to you \"as-is\" without any warranty. No\n",
      "     warranties of any kind, expressed or implied, are made to you as to\n",
      "     the text or any medium it may be on, including but not limited to\n",
      "     warranties of merchantablity or fitness for a particular purpose.\n",
      "\n",
      "     This text was formatted from various free ASCII and HTML variants.\n",
      "     See http://sherlock-holm.es for an electronic form of this text and\n",
      "     additional information about it.\n",
      "\n",
      "     This text comes from the collection's version 3.1.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "36831\n"
     ]
    }
   ],
   "source": [
    "path = 'sherlock'\n",
    "\n",
    "files = os.listdir(path)\n",
    "stories = {}\n",
    "files.sort(key=lambda x: int(os.path.splitext(x)[0]))  # Sort based on the numeric part of the filename  bc \\os.listdir(path),sorts alphabetically (not numerically).\n",
    "\n",
    "# Iterate over each file in the folder\n",
    "for idx, file in enumerate(files):\n",
    "    with open(os.path.join(path, file), 'r') as data:\n",
    "        contents = data.read()\n",
    "        stories[idx] = contents  \n",
    "\n",
    "# Access stories using numeric indices\n",
    "print(stories[1])  \n",
    "print(len(stories[1]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Task 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Clean the Sherlock Holmes dataset to handle common text preprocessing challenges, provide a short report detailing preprocessing challenges and how they were addressed. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Challenges presented to non processed text:\n",
    "\n",
    "- Includes punctuation\n",
    "- Includes Numbers which are dates and times (the : punctuation in time is removed so it's just a sequence of numbers)\n",
    "- Includes uppercase letters \n",
    "- Copyright text at the end of the story after ---------- \n",
    "- Some stories include table of contexts \n",
    "- includes the author and the title at the beginning"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Remove Copyright text & Special Characters, Convert to LowerCase & Tokenize "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Version 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this version we removed non-neccecary text & special characters, turned the text into lowercaase and tokenized it. This version includes stopwords."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "nltk.download('punkt')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "stories_wstopwords = {}\n",
    "\n",
    "for i in stories:\n",
    "    # Split the story at the dashes and keep only the story part (not the information about copyrights)\n",
    "    stories_wstopwords[i] = stories[i].split(\"----------\")[0]\n",
    " \n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories_wstopwords[i]:\n",
    "        content_after_chapter = stories_wstopwords[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories_wstopwords[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories_wstopwords[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories_wstopwords[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories_wstopwords[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "        \n",
    "    # Remove special characters\n",
    "    stories_wstopwords[i] = re.sub(r\"[^\\w ]\", \"\", stories_wstopwords[i], flags=re.I) #using regex to remove special characters \n",
    "\n",
    "    # Convert to lowercase\n",
    "    stories_wstopwords[i] = stories_wstopwords[i].lower() \n",
    "\n",
    "    #Tokenization\n",
    "    #stories[i]= stories[i].split() # Split into words\n",
    "    stories_wstopwords[i] = nltk.word_tokenize(stories_wstopwords[i]) # Split into words taking account of punctuation \n",
    "\n",
    "\n",
    "# Checking the first story  \n",
    "print(stories_wstopwords[1])\n",
    "# Checking the length of the first story\n",
    "print(len(stories_wstopwords[1]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Original:\n",
    "\n",
    "```\n",
    " I have never known my friend to be in better form, both mental and physical, than in the year '95.\n",
    "```\n",
    "Edited (without tokenization):\n",
    "\n",
    "```\n",
    "i have never known my friend to be in better form both mental and physical than in the year 95\n",
    "```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Write the cleaned content to a new file called story_test.txt as the print method doesn't display the entire content\n",
    "with open(\"story_test.txt\", \"w\") as file:\n",
    "    file.write(\" \".join(stories[13]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Version 2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This version is the same as the first one but we are removing stopwords as well."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "stories_processed = {}\n",
    "\n",
    "# Define the set of stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to remove stopwords from a list of tokens\n",
    "def remove_stopwords(tokens):\n",
    "    return [word for word in tokens if word.lower() not in stop_words]\n",
    "\n",
    "for i in stories:\n",
    "    # Split the story at the dashes and keep only the story part (not the information about copyrights)\n",
    "    stories_processed[i] = stories[i].split(\"----------\")[0]\n",
    "    \n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories_processed[i]:\n",
    "        content_after_chapter = stories_processed[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories_processed[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories_processed[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories_processed[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories_processed[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "    \n",
    "\n",
    "    # Remove special characters\n",
    "    stories_processed[i] = re.sub(r\"[^\\w ]\", \"\", stories_processed[i], flags=re.I) #using regex to remove special characters \n",
    "\n",
    "    # Convert to lowercase\n",
    "    stories_processed[i] = stories_processed[i].lower() \n",
    "\n",
    "    #Tokenization\n",
    "    #stories[i]= stories[i].split() # Split into words\n",
    "    stories_processed[i] = nltk.word_tokenize(stories_processed[i]) # Split into words taking account of punctuation \n",
    "\n",
    "    # Remove stopwords\n",
    "    stories_processed[i] = remove_stopwords(stories_processed[i])\n",
    "\n",
    "\n",
    "# Checking the first story  \n",
    "print(stories_processed[1])\n",
    "# Checking the length of the first story\n",
    "print(len(stories_processed[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Write the cleaned content to a new file called story_test.txt as the print method doesn't display the entire content\n",
    "with open(\"story_test.txt\", \"w\") as file:\n",
    "    file.write(\" \".join(stories_processed[1]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the code above we used word_tokenize to tokenize the text. In this case it doesn't make a difference between using split and word_tokenize as we have removed punctuation already."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Version 3"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Lets sentence segmentation and word tokenization handle punctuation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This version also includes tagging "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "nltk.download('punkt')\n",
    "nltk.download('averaged_perceptron_tagger')\n",
    "nltk.download('stopwords')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.tokenize import sent_tokenize, word_tokenize\n",
    "from nltk import pos_tag\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "\n",
    "# Define the set of stopwords \n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to remove stopwords from a list of tokens\n",
    "def remove_stopwords(tokens):\n",
    "    return [word for word in tokens if word.lower() not in stop_words]\n",
    "\n",
    "\n",
    "# Iterate through the stories dictionary\n",
    "for i in stories:\n",
    "    # Step 1: Remove the copyright section\n",
    "    story_content = stories[i]\n",
    "    story_content = story_content.split(\"----------\")[0]\n",
    "\n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories[i]:\n",
    "        content_after_chapter = stories[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "    \n",
    "\n",
    "    # Step 2: Sentence segmentation\n",
    "    sentences = sent_tokenize(story_content)\n",
    "\n",
    "    # Step 3: Tokenization and POS tagging\n",
    "    tokenized_and_tagged = []\n",
    "    for sentence in sentences:\n",
    "        # Tokenize the sentence\n",
    "        tokens = word_tokenize(sentence)\n",
    "\n",
    "        #stop word removal\n",
    "        remove_stop = remove_stopwords(tokens)\n",
    "        # POS tagging for the tokens\n",
    "        tagged_tokens = pos_tag(remove_stop)\n",
    "        # Append tagged tokens to the result\n",
    "        tokenized_and_tagged.extend(tagged_tokens)\n",
    "\n",
    "    # Step 4: Overwrite the story with the tagged tokens\n",
    "    stories[i] = tokenized_and_tagged\n",
    "\n",
    "# Checking the first story\n",
    "print(stories[1])\n",
    "print(len(stories[1]))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Write the cleaned content to a new file called story_test.txt as the print method doesn't display the entire content\n",
    "with open(\"story_test.txt\", \"w\") as file:\n",
    "    file.write(\" \".join(stories[9]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dealing with numbers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Problem:\n",
    "- The way we have to deal with numbers depends on the task. In some tasks the actual numbers can be irrevelant and can be replaced with placeholders. However, removing them can potentially change the context/topic. For example, I have a K9 dog. -> I have a K dog.\n",
    "\n",
    "Solutions:\n",
    "1. A dummy token, such as <NUMBER> can be used, so that the fact that there was a number in the original text is preserved,  without disturbing the syntactic context.\n",
    "\n",
    "--- \n",
    "We will evaluate how each solution influences perfomance."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Solution 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*A dummy token, such as <NUMBER> can be used, so that the fact that there was a number in the original text is preserved,  without disturbing the syntactic context.*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### version 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    " \n",
    "for i in stories:\n",
    "    # Split the story at the dashes and keep only the story part (not the information about copyrights)\n",
    "    stories[i] = stories[i].split(\"----------\")[0]\n",
    "\n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories[i]:\n",
    "        content_after_chapter = stories[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "    \n",
    "    #using regex to replace numbers with <NUMBER> tag\n",
    "    stories[i] = re.sub(r\"\\d\", \" <NUMBER> \",stories[i]) \n",
    "\n",
    "    # using regex to remove special characters\n",
    "    stories[i] = re.sub(r\"[^\\w ]\", \"\", stories[i], flags=re.I)    \n",
    "\n",
    "    # Convert to lowercase\n",
    "    stories[i] = stories[i].lower() \n",
    "\n",
    "    #Tokenization\n",
    "    stories[i] = nltk.word_tokenize(stories[i]) # Split into words taking account of punctuation \n",
    "\n",
    "print(stories[1])\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### version 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.tokenize import sent_tokenize, word_tokenize\n",
    "from nltk import pos_tag\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "\n",
    "# Define the set of stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to remove stopwords from a list of tokens\n",
    "def remove_stopwords(tokens):\n",
    "    return [word for word in tokens if word.lower() not in stop_words]\n",
    "\n",
    "\n",
    "# Iterate through the stories dictionary\n",
    "for i in stories:\n",
    "    # Step 1: Remove the copyright section\n",
    "    stories[i] = stories[i].split(\"----------\")[0]\n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories[i]:\n",
    "        content_after_chapter = stories[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "        \n",
    "    stories[i] = re.sub(r\"\\d\", \" <NUMBER> \",stories[i]) \n",
    "\n",
    "    # Step 2: Sentence segmentation\n",
    "    sentences = sent_tokenize(stories[i])\n",
    "\n",
    "    # Step 3: Tokenization and POS tagging\n",
    "    tokenized_and_tagged = []\n",
    "    for sentence in sentences:\n",
    "        # Tokenize the sentence\n",
    "        tokens = word_tokenize(sentence)\n",
    "\n",
    "        #stop word removal\n",
    "        remove_stop = remove_stopwords(tokens)\n",
    "        # POS tagging for the tokens\n",
    "        tagged_tokens = pos_tag(remove_stop)\n",
    "        # Append tagged tokens to the result\n",
    "        tokenized_and_tagged.extend(tagged_tokens)\n",
    "\n",
    "    # Step 4: Overwrite the story with the tagged tokens\n",
    "    stories[i] = tokenized_and_tagged\n",
    "\n",
    "# Checking the first story\n",
    "print(stories[1])\n",
    "print(len(stories[1]))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Original:\n",
    "\n",
    "```\n",
    " I have never known my friend to be in better form, both mental and physical, than in the year '95.\n",
    "```\n",
    "Edited (without tokenization):\n",
    "\n",
    "```\n",
    "i have never known my friend to be in better form both mental and physical than in the year number number\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The problem with this solution is that not all numbers have the same context. Some numbers are dates for example 25th December, others are time for example 11:00 AM etc."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### version 3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "\n",
    "# Define the set of stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to remove stopwords from a list of tokens\n",
    "def remove_stopwords(tokens):\n",
    "    return [word for word in tokens if word.lower() not in stop_words]\n",
    "\n",
    "for i in stories:\n",
    "    # Split the story at the dashes and keep only the story part (not the information about copyrights)\n",
    "    stories[i] = stories[i].split(\"----------\")[0]\n",
    "    \n",
    "   # Check if 'CHAPTER I' exists before trying to split by it\n",
    "    if \"CHAPTER I\" in stories[i]:\n",
    "        content_after_chapter = stories[i].split(\"CHAPTER I\")[1] # remove text before CHAPTER 1 to remove table of contexts and titles authors, etc\n",
    "      # remove the first line immediately after \"CHAPTER I\"\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        stories[i] = \"\\n\".join(content_lines[2:]) \n",
    "    elif \"Arthur Conan Doyle\" in stories[i]:\n",
    "        # Remove text before \"Arthur Conan Doyle\" if \"CHAPTER I\" does not exist\n",
    "        parts = stories[i].split(\"Arthur Conan Doyle\")\n",
    "        # Keep everything after the last occurrence of the author\n",
    "        stories[i] = parts[-1] if len(parts) > 1 else parts[0]  \n",
    "    \n",
    "    # replace numbers with NUMBER\n",
    "    stories[i] = re.sub(r\"\\d\", \" <NUMBER> \",stories[i]) \n",
    "\n",
    "    # Remove special characters\n",
    "    stories[i] = re.sub(r\"[^\\w ]\", \"\", stories[i], flags=re.I) #using regex to remove special characters \n",
    "\n",
    "    # Convert to lowercase\n",
    "    stories[i] = stories[i].lower() \n",
    "\n",
    "    #Tokenization\n",
    "    #stories[i]= stories[i].split() # Split into words\n",
    "    stories[i] = nltk.word_tokenize(stories[i]) # Split into words taking account of punctuation \n",
    "\n",
    "    # Remove stopwords\n",
    "    stories[i] = remove_stopwords(stories[i])\n",
    "\n",
    "\n",
    "# Checking the first story  \n",
    "print(stories[1])\n",
    "# Checking the length of the first story\n",
    "print(len(stories[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install num2words\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from num2words import num2words\n",
    "\n",
    "# Function to convert numbers in a list of tokens to words\n",
    "def convert_numbers_to_words(tokens):\n",
    "    return [num2words(word) if word.isdigit() else word for word in tokens]\n",
    "\n",
    "# Iterate through stories to replace numbers with words\n",
    "for i in range(len(stories)):\n",
    "    # Convert numbers to words for each story\n",
    "    stories[i] = convert_numbers_to_words(stories[i])\n",
    "\n",
    "# Example: Check the first story after conversion\n",
    "print(stories[0])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Write the cleaned content to a new file called story_test.txt as the print method doesn't display the entire content\n",
    "with open(\"story_test.txt\", \"w\") as file:\n",
    "    file.write(\" \".join(stories[60]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Task 2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Implement a Seq2Seq model using an Encoder-Decoder LSTM architecture for summarizing entire Sherlock Holmes stories into short summaries. \n",
    "- Train the model to produce summaries of around 50-100 words.  \n",
    "- Evaluate the model on both using suitable score metrics based on your research."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Story Summarization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import nltk\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "# Define the stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "def remove_stopwords(tokens):\n",
    "    \"\"\"Remove stopwords from a list of tokens.\"\"\"\n",
    "    return [word for word in tokens if word.lower() not in stop_words]\n",
    "\n",
    "def process_story(story):\n",
    "    \"\"\"\n",
    "    Process a single story by performing:\n",
    "    - Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'.\n",
    "    - Remove the line immediately following 'CHAPTER I'.\n",
    "    - Remove special characters.\n",
    "    - Convert to lowercase.\n",
    "    - Tokenize text into words.\n",
    "    - Remove stopwords.\n",
    "\n",
    "    Returns:\n",
    "        str: The cleaned story as a single string.\n",
    "    \"\"\"\n",
    "    # Step 1: Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        content_after_chapter = story.split(\"CHAPTER I\")[1]\n",
    "        content_lines = content_after_chapter.split(\"\\n\")\n",
    "        story = \"\\n\".join(content_lines[1:])  # Remove the first line after 'CHAPTER I'\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        parts = story.split(\"Arthur Conan Doyle\")\n",
    "        story = parts[-1] if len(parts) > 1 else parts[0]  # Keep text after the last occurrence\n",
    "\n",
    "    # Step 2: Remove special characters\n",
    "    story = re.sub(r\"[^\\w ]\", \"\", story, flags=re.I)\n",
    "\n",
    "    # Step 3: Convert to lowercase\n",
    "    story = story.lower()\n",
    "\n",
    "    # Step 4: Tokenization\n",
    "    tokens = nltk.word_tokenize(story)\n",
    "\n",
    "    # Step 5: Remove stopwords\n",
    "    tokens = remove_stopwords(tokens)\n",
    "\n",
    "    return \" \".join(tokens)  # Return the cleaned story as a string\n",
    "\n",
    "def create_summary(stories, num_words=10, num_sentences=5):\n",
    "    \"\"\"\n",
    "    Create summaries for each story after cleaning them based on top word frequencies.\n",
    "\n",
    "    Parameters:\n",
    "        stories (dict): Dictionary of original stories (not tokenized).\n",
    "        num_words (int): Number of top words to use for summary generation.\n",
    "        num_sentences (int): Number of sentences to extract for the summary.\n",
    "\n",
    "    Returns:\n",
    "        dict: Dictionary containing summaries for each story.\n",
    "    \"\"\"\n",
    "    # Step 1: Process all stories\n",
    "    cleaned_stories = {story_id: process_story(story) for story_id, story in stories.items()}\n",
    "\n",
    "    # Step 2: Compute word frequencies for each cleaned story\n",
    "    word_frequencies = {}\n",
    "    for story_id, story in cleaned_stories.items():\n",
    "        word_freq = {}\n",
    "        for word in story.split():  # Story is now a cleaned string\n",
    "            word_freq[word] = word_freq.get(word, 0) + 1\n",
    "        word_frequencies[story_id] = word_freq\n",
    "\n",
    "    # Step 3: Generate summaries\n",
    "    summaries = {}\n",
    "    for story_id, cleaned_story in cleaned_stories.items():\n",
    "        # Get the top `num_words` frequent words\n",
    "        top_words = sorted(word_frequencies[story_id].items(), key=lambda x: x[1], reverse=True)[:num_words]\n",
    "        top_words = [word for word, freq in top_words]\n",
    "\n",
    "        # Split the cleaned story into sentences\n",
    "        sentences = cleaned_story.split('. ')  # Split by periods\n",
    "\n",
    "        # Find sentences containing frequent words\n",
    "        selected_sentences = []\n",
    "        for sentence in sentences:\n",
    "            # Remove stopwords from each sentence before comparison\n",
    "            sentence_tokens = remove_stopwords(nltk.word_tokenize(sentence))\n",
    "            if any(word in sentence_tokens for word in top_words):\n",
    "                selected_sentences.append(sentence.strip())\n",
    "            if len(selected_sentences) >= num_sentences:  # Stop after reaching the desired number of sentences\n",
    "                break\n",
    "\n",
    "        # Combine selected sentences into a summary\n",
    "        summaries[story_id] = ' '.join(selected_sentences)\n",
    "\n",
    "    return summaries\n",
    "\n",
    "# Example Usage:\n",
    "\n",
    "# Assuming `stories` is your dictionary of raw story text\n",
    "summaries = create_summary(stories, num_words=10, num_sentences=5)\n",
    "\n",
    "# Display summaries for each story\n",
    "for story_id, summary in summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import nltk\n",
    "import re\n",
    "from nltk.tokenize import word_tokenize, sent_tokenize\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "# Define the set of stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to clean and process a story\n",
    "def clean_story(story):\n",
    "    # Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        story = story.split(\"CHAPTER I\")[1]\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        story = story.split(\"Arthur Conan Doyle\")[-1]\n",
    "    \n",
    "    # Remove special characters\n",
    "    story = re.sub(r\"[^\\w\\s.]\", \"\", story)\n",
    "    \n",
    "    # Convert to lowercase\n",
    "    story = story.lower()\n",
    "    \n",
    "    return story\n",
    "\n",
    "# Function to summarize a story\n",
    "def summarize_story(text):\n",
    "    # Tokenize words and sentences\n",
    "    words = word_tokenize(text)\n",
    "    sentences = sent_tokenize(text)\n",
    "    \n",
    "    # Build a frequency table for the words\n",
    "    freq_table = {}\n",
    "    for word in words:\n",
    "        word = word.lower()\n",
    "        if word not in stop_words:\n",
    "            freq_table[word] = freq_table.get(word, 0) + 1\n",
    "    \n",
    "    # Score each sentence based on word frequencies\n",
    "    sentence_scores = {}\n",
    "    for sentence in sentences:\n",
    "        for word, freq in freq_table.items():\n",
    "            if word in sentence.lower():\n",
    "                sentence_scores[sentence] = sentence_scores.get(sentence, 0) + freq\n",
    "    \n",
    "    # Calculate the average sentence score\n",
    "    avg_score = sum(sentence_scores.values()) / len(sentence_scores)\n",
    "    \n",
    "    # Generate a summary by selecting sentences with a score above a threshold\n",
    "    summary = \"\"\n",
    "    for sentence in sentences:\n",
    "        if sentence in sentence_scores and sentence_scores[sentence] > 1.2 * avg_score:\n",
    "            summary += sentence + \" \"\n",
    "    \n",
    "    return summary.strip()\n",
    "\n",
    "# Clean and summarize each story\n",
    "summaries = {}\n",
    "for story_id, story_text in stories.items():\n",
    "    # Clean the story\n",
    "    cleaned_story = clean_story(story_text)\n",
    "    \n",
    "    # Summarize the story\n",
    "    summary = summarize_story(cleaned_story)\n",
    "    \n",
    "    # Store the summary\n",
    "    summaries[story_id] = summary\n",
    "\n",
    "# Display summaries for each story\n",
    "for story_id, summary in summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(\"\\n\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "https://www.topcoder.com/thrive/articles/text-summarization-in-nlp"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import nltk\n",
    "import re\n",
    "from nltk.tokenize import word_tokenize, sent_tokenize\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "\n",
    "# Define the set of stopwords globally\n",
    "stop_words = set(stopwords.words('english'))\n",
    "\n",
    "# Function to clean and process a story\n",
    "def clean_story(story):\n",
    "    # Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        story = story.split(\"CHAPTER I\")[1]\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        story = story.split(\"Arthur Conan Doyle\")[-1]\n",
    "    \n",
    "    # Remove special characters\n",
    "    story = re.sub(r\"[^\\w\\s.]\", \"\", story)\n",
    "    \n",
    "    # Convert to lowercase\n",
    "    story = story.lower()\n",
    "    \n",
    "    return story\n",
    "\n",
    "# Function to summarize a story\n",
    "def summarize_story(text):\n",
    "    # Tokenize words and sentences\n",
    "    words = word_tokenize(text)\n",
    "    sentences = sent_tokenize(text)\n",
    "    \n",
    "    # Build a frequency table for the words\n",
    "    freq_table = {}\n",
    "    for word in words:\n",
    "        word = word.lower()\n",
    "        if word not in stop_words:\n",
    "            freq_table[word] = freq_table.get(word, 0) + 1\n",
    "    \n",
    "    # Score each sentence based on word frequencies\n",
    "    sentence_scores = {}\n",
    "    for sentence in sentences:\n",
    "        for word, freq in freq_table.items():\n",
    "            if word in sentence.lower():\n",
    "                sentence_scores[sentence] = sentence_scores.get(sentence, 0) + freq\n",
    "    \n",
    "    # Calculate the average sentence score\n",
    "    avg_score = sum(sentence_scores.values()) / len(sentence_scores)\n",
    "    \n",
    "    # Select sentences to form the summary (between 50-100 words)\n",
    "    summary_sentences = []\n",
    "    total_words = 0\n",
    "    for sentence in sorted(sentence_scores, key=sentence_scores.get, reverse=True):\n",
    "        word_count = len(word_tokenize(sentence))\n",
    "        if total_words + word_count <= 100:\n",
    "            summary_sentences.append(sentence)\n",
    "            total_words += word_count\n",
    "        if total_words >= 50:  # Ensure the summary is at least 50 words\n",
    "            break\n",
    "    \n",
    "    # Combine the selected sentences into a summary\n",
    "    summary = \" \".join(summary_sentences)\n",
    "    \n",
    "    return summary\n",
    "\n",
    "# Clean and summarize each story\n",
    "summaries = {}\n",
    "for story_id, story_text in stories.items():\n",
    "    # Clean the story\n",
    "    cleaned_story = clean_story(story_text)\n",
    "    \n",
    "    # Summarize the story\n",
    "    summary = summarize_story(cleaned_story)\n",
    "    \n",
    "    # Store the summary\n",
    "    summaries[story_id] = summary\n",
    "\n",
    "# Display summaries for each story\n",
    "for story_id, summary in summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(f\"Word Count: {len(word_tokenize(summary))}\")\n",
    "    print(\"\\n\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install sumy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load Required Packages\n",
    "from sumy.parsers.plaintext import PlaintextParser\n",
    "from sumy.nlp.tokenizers import Tokenizer\n",
    "from sumy.summarizers.text_rank import TextRankSummarizer\n",
    "\n",
    "\n",
    "\n",
    "# Function to clean and prepare story text\n",
    "def clean_story(story):\n",
    "    # Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        story = story.split(\"CHAPTER I\")[1]\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        story = story.split(\"Arthur Conan Doyle\")[-1]\n",
    "    \n",
    "    # Remove special characters\n",
    "    story = re.sub(r\"[^\\w\\s.]\", \"\", story)\n",
    "    \n",
    "    # Convert to lowercase\n",
    "    story = story.lower()\n",
    "    \n",
    "    return story\n",
    "\n",
    "# Function to summarize a story using Sumy TextRank\n",
    "def summarize_story_with_sumy(story_text, num_sentences=2):\n",
    "    # Clean the story text\n",
    "    cleaned_text = clean_story(story_text)\n",
    "    \n",
    "    # Create text parser using tokenization\n",
    "    parser = PlaintextParser.from_string(cleaned_text, Tokenizer(\"english\"))\n",
    "    \n",
    "    # Initialize TextRank summarizer\n",
    "    summarizer = TextRankSummarizer()\n",
    "    \n",
    "    # Generate summary with the specified number of sentences\n",
    "    summary = summarizer(parser.document, num_sentences)\n",
    "    \n",
    "    # Combine summary sentences into a single string\n",
    "    text_summary = \" \".join(str(sentence) for sentence in summary)\n",
    "    \n",
    "    return text_summary\n",
    "\n",
    "# Summarize each story\n",
    "summaries = {}\n",
    "for story_id, story_text in stories.items():\n",
    "    summaries[story_id] = summarize_story_with_sumy(story_text, num_sentences=2)\n",
    "\n",
    "# Display summaries\n",
    "for story_id, summary in summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(\"\\n\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from transformers import BartForConditionalGeneration, BartTokenizer\n",
    "import torch\n",
    "import re\n",
    "\n",
    "# Function to clean and prepare story text\n",
    "def clean_story(story):\n",
    "    # Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        story = story.split(\"CHAPTER I\")[1]\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        story = story.split(\"Arthur Conan Doyle\")[-1]\n",
    "    \n",
    "    # Remove special characters\n",
    "    #story = re.sub(r\"[^\\w\\s.]\", \"\", story)\n",
    "    story = re.sub(r\"[^\\w\\s.]\", \"\", story)\n",
    "\n",
    "    # Convert to lowercase\n",
    "    #story = story.lower()\n",
    "    \n",
    "    return story\n",
    "\n",
    "# Function to summarize a story using BART\n",
    "def summarize_with_bart(story_text, max_length=100, min_length=50):\n",
    "    # Load pre-trained BART model and tokenizer\n",
    "    model_name = \"facebook/bart-large-cnn\"\n",
    "    model = BartForConditionalGeneration.from_pretrained(model_name).to(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "    tokenizer = BartTokenizer.from_pretrained(model_name)\n",
    "    \n",
    "    story_text = clean_story(story_text)\n",
    "\n",
    "    # Tokenize input text (story)\n",
    "    inputs = tokenizer(story_text, return_tensors=\"pt\", max_length=1024, truncation=True)\n",
    "    \n",
    "    # Send inputs to GPU if available (use 'cpu' if not available)\n",
    "    inputs = {key: value.to(model.device) for key, value in inputs.items()}\n",
    "    \n",
    "    # Generate summary\n",
    "    summary_ids = model.generate(\n",
    "        inputs[\"input_ids\"], \n",
    "        max_length=max_length, \n",
    "        min_length=min_length, \n",
    "        length_penalty=2.0, \n",
    "        num_beams=4, \n",
    "        early_stopping=True\n",
    "    )\n",
    "    \n",
    "    # Decode summary\n",
    "    summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)\n",
    "    \n",
    "    return summary\n",
    "\n",
    "\n",
    "# Summarize each story\n",
    "summaries = {}\n",
    "for story_id, story_text in stories.items():\n",
    "    # Clean and summarize each story\n",
    "    summary = summarize_with_bart(story_text)\n",
    "    summaries[story_id] = summary\n",
    "\n",
    "# Display summaries\n",
    "for story_id, summary in summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(\"\\n\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "summaries[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Summary of Story 0:\n",
      "This strange, languid creature spent his waking hours in the bow window of a St.  Jamess Street club and was the receivingstation as well as the transmitter for all the gossip of the metropolis. She rose from a settee as we entered tall, queenly, a perfect figure, a lovely masklike face, with two wonderful Spanish eyes which looked murder at us both. It was quite evident that The Three Gables was under very close surveillance, for as we came round the high hedge at the end of the lane there was the negro prizefighter standing in the shadow. He was in a chatty mood that morning, however, and had just settled me into the wellworn low armchair on one side of the fire, while he had curled down with his pipe in his mouth upon the opposite chair, when our visitor arrived. A minute later we were in an Arabian Nights drawingroom, vast and wonderful, in a half gloom, picked out with an occasional pink electric light.\n",
      "\n",
      "\n",
      "Summary of Story 1:\n",
      "It was twilight of a lovely spring evening, and even Little Ryder Street, one of the smaller offshoots from the Edgware Road, within a stonecast of old Tyburn Tree of evil memory, looked golden and wonderful in the slanting rays of the setting sun. Our eyes fell upon a mass of rusted machinery, great rolls of paper, a litter of bottles, and, neatly arranged upon a small table, a number of neat little bundles. He made his money in real estate, and afterwards in the wheat pit at Chicago, but he spent it in buying up as much land as would make one of your counties, lying along the Arkansas River, west of Fort Dodge. The particular house to which we were directed was a large, oldfashioned, Early Georgian edifice, with a flat brick face broken only by two deep bay windows on the ground floor. This is how it ran Howard Garrideb Constructor of Agricultural Machinery Binders, reapers, steam and hand plows, drills, harrows, farmers carts, buckboards, and all other appliances.\n",
      "\n",
      "\n",
      "Summary of Story 2:\n",
      "I may add that I walked out to the athletic grounds this morning, saw that tenacious black clay is used in the jumpingpit, and carried away a specimen of it, together with some of the fine tan or sawdust which is strewn over it to prevent the athlete from slipping. It was in the year 95 that a combination of events, into which I need not enter, caused Mr.  Sherlock Holmes and myself to spend some weeks in one of our great University towns, and it was during this time that the small but instructive adventure which I am about to relate befell us. We were residing at the time in furnished lodgings close to a library where Sherlock Holmes was pursuing some laborious researches in early English chartersresearches which led to results so striking that they may be the subject of one of my future narratives. What with your eternal tobacco, Watson, and your irregularity at meals, I expect that you will get notice to quit and that I shall share your downfallnot, however, before we have solved the problem of the nervous tutor, the careless servant, and the three enterprising students. The same curious accident happened to him in the rooms of the Indiana silent, little, hooknosed fellow, who eyed us askance and was obviously glad when Holmess architectural studies had come to an end.\n",
      "\n",
      "\n",
      "Summary of Story 3:\n",
      "The household of the Abbey Grange were much surprised at our return, but Sherlock Holmes, finding that Stanley Hopkins had gone off to report to headquarters, took possession of the diningroom, locked the door upon the inside, and devoted himself for two hours to one of those minute and laborious investigations which formed the solid basis on which his brilliant edifices of deduction were reared. But if I have hit upon the true explanation of this one small phenomenon, then in an instant the case rises from the commonplace to the exceedingly remarkable, for it can only mean that Lady Brackenstall and her maid have deliberately lied to us, that not one word of their story is to be believed, that they have some very strong reason for covering the real criminal, and that we must construct our case for ourselves without any help from them. Excuse me, my dear fellow, said he, as we watched the rear carriages of our train disappearing round a curve I am sorry to make you the victim of what may seem a mere whim, but on my life, Watson, I simply cant leave that case in this condition. Every now and then, by an effort, he would throw off the impression and talk as if the matter were clear, but then his doubts would settle down upon him again, and his knitted brows and abstracted eyes would show that his thoughts had gone back once more to the great diningroom of the Abbey Grange in which this midnight tragedy had been enacted. Well, gentlemen, I was standing with her just inside the window, in all innocence, as Heaven is my judge, when he rushed like a madman into the room, called her the vilest name that a man could use to a woman, and welted her across the face with the stick he had in his hand.\n",
      "\n",
      "\n",
      "Summary of Story 4:\n",
      "My own complete happiness, and the homecentred interests which rise up around the man who first finds himself master of his own establishment, were sufficient to absorb all my attention, while Holmes, who loathed every form of society with his whole Bohemian soul, remained in our lodgings in Baker Street, buried among his old books, and alternating from week to week between cocaine and ambition, the drowsiness of the drug, and the fierce energy of his own keen nature. From time to time I heard some vague account of his doings of his summons to Odessa in the case of the Trepoff murder, of his clearing up of the singular tragedy of the Atkinson brothers at Trincomalee, and finally of the mission which he had accomplished so delicately and successfully for the reigning family of Holland. Heavy bands of astrakhan were slashed across the sleeves and fronts of his doublebreasted coat, while the deep blue cloak which was thrown over his shoulders was lined with flamecoloured silk and secured at the neck with a brooch which consisted of a single flaming beryl. As to your practice, if a gentleman walks into my rooms smelling of iodoform, with a black mark of nitrate of silver upon his right forefinger, and a bulge on the right side of his tophat to show where he has secreted his stethoscope, I must be dull, indeed, if I do not pronounce him to be an active member of the medical profession. He was still, as ever, deeply attracted by the study of crime, and occupied his immense faculties and extraordinary powers of observation in following out those clues, and clearing up those mysteries which had been abandoned as hopeless by the official police.\n",
      "\n",
      "\n",
      "Summary of Story 5:\n",
      "You suppose that your son came down from his bed, went, at great risk, to your dressingroom, opened your bureau, took out your coronet, broke off by main force a small portion of it, went off to some other place, concealed three gems out of the thirtynine, with such skill that nobody can find them, and then returned with the other thirtysix into the room in which he exposed himself to the greatest danger of being discovered. I went in the shape of a loafer to Sir Georges house, managed to pick up an acquaintance with his valet, learned that his master had cut his head the night before, and, finally, at the expense of six shillings, made all sure by buying a pair of his castoff shoes. I confess that the guilt of the bankers son appeared to me to be as obvious as it did to his unhappy father, but still I had such faith in Holmes judgment that I felt that there must be some grounds for hope as long as he was dissatisfied with the accepted explanation. Then something suddenly snapped, and your son, finding that he had the coronet in his hands, rushed back, closed the window, ascended to your room, and had just observed that the coronet had been twisted in the struggle and was endeavouring to straighten it when you appeared upon the scene. A man had waited outside the window someone had brought the gems the deed had been overseen by your son he had pursued the thief had struggled with him they had each tugged at the coronet, their united strength causing injuries which neither alone could have effected.\n",
      "\n",
      "\n",
      "Summary of Story 6:\n",
      "In this memorable year 95 a curious and incongruous succession of cases had engaged his attention, ranging from his famous investigation of the sudden death of Cardinal Toscaan inquiry which was carried out by him at the express desire of His Holiness the Popedown to his arrest of Wilson, the notorious canarytrainer, which removed a plaguespot from the EastEnd of London. At first the steps of a few belated villagers, or the sound of voices from the village, lightened our vigil but one by one these interruptions died away and an absolute stillness fell upon us, save for the chimes of the distant church, which told us of the progress of the night, and for the rustle and whisper of a fine rain falling amid the foliage which roofed us in. So unworldly was heor so capriciousthat he frequently refused his help to the powerful and wealthy where the problem made no appeal to his sympathies, while he would devote weeks of most intense application to the affairs of some humble client whose case presented those strange and dramatic qualities which appealed to his imagination and challenged his ingenuity. Stanley Hopkins led us first to the house, where he introduced us to a haggard, greyhaired woman, the widow of the murdered man, whose gaunt and deeplined face, with the furtive look of terror in the depths of her redrimmed eyes, told of the years of hardship and illusage which she had endured. Vast sections of it have been cleared, for this is the seat of the first ironworks of the country, and the trees have been felled to smelt the ore.  Now the richer fields of the North have absorbed the trade, and nothing save these ravaged groves and great scars in the earth show the work of the past.\n",
      "\n",
      "\n",
      "Summary of Story 7:\n",
      "It seemed that none of them could speak English, but the situation wanted clearing up, for the creature with the big head was growing furiously angry, and, uttering wildbeast cries, he had laid his deformed hands upon me and was dragging me out of bed, regardless of the fresh flow of blood from my wound. Speaking of my old friend and biographer, I would take this opportunity to remark that if I burden myself with a companion in my various little inquiries it is not done out of sentiment or caprice, but it is that Watson has some remarkable characteristics of his own to which in his modesty he has given small attention amid his exaggerated estimates of my own performances. I wrote to the mother, thereforeI had had quite enough of the curmudgeon of a fatherand I made a clean frontal attack Godfrey was my chum, I had a great deal of interest which I might tell her of our common experiences, I should be in the neighbourhood, would there be any objection, et cetera? In front of me was standing a small, dwarflike man with a huge, bulbous head, who was jabbering excitedly in Dutch, waving two horrible hands which looked to me like brown sponges. I have a dim memory of slowly ascending the steps, entering a wideopened door, passing into a large room which contained several beds, and throwing myself down with a gasp of satisfaction upon one of them.\n",
      "\n",
      "\n",
      "Summary of Story 8:\n",
      "Peterson had rushed forward to protect the stranger from his assailants but the man, shocked at having broken the window, and seeing an officiallooking person in uniform rushing towards him, dropped his goose, took to his heels, and vanished amid the labyrinth of small streets which lie at the back of Tottenham Court Road. Turning round we saw a little ratfaced fellow standing in the centre of the circle of yellow light which was thrown by the swinging lamp, while Breckinridge, the salesman, framed in the door of his stall, was shaking his fists fiercely at the cringing figure. It is true that For Mrs.  Henry Baker was printed upon a small card which was tied to the birds left leg, and it is also true that the initials H.  B.  are legible upon the lining of this hat, but as there are some thousands of Bakers, and some hundreds of Henry Bakers in this city of ours, it is not easy to restore lost property to any one of them. This dust, you will observe, is not the gritty, grey dust of the street but the fluffy brown dust of the house, showing that it has been hung up indoors most of the time, while the marks of moisture upon the inside are proof positive that the wearer perspired very freely, and could therefore, hardly be in the best of training. James Ryder, upperattendant at the hotel, gave his evidence to the effect that he had shown Horner up to the dressingroom of the Countess of Morcar upon the day of the robbery in order that he might solder the second bar of the grate, which was loose.\n",
      "\n",
      "\n",
      "Summary of Story 9:\n",
      "As to his remark about his deserts, it was also not unnatural if you consider that he stood beside the dead body of his father, and that there is no doubt that he had that very day so far forgotten his filial duty as to bandy words with him, and even, according to the little girl whose evidence is so important, to raise his hand as if to strike him. Does it not strike you as a little singular that this McCarthy, who appears to have had little of his own, and to have been under such obligations to Turner, should still talk of marrying his son to Turners daughter, who is, presumably, heiress to the estate, and that in such a very cocksure manner, as if it were merely a case of a proposal and all else would follow? His tangled beard, grizzled hair, and outstanding, drooping eyebrows combined to give an air of dignity and power to his appearance, but his face was of an ashen white, while his lips and the corners of his nostrils were tinged with a shade of blue. Supposing that this unhappy young mans story were absolutely true, then what hellish thing, what absolutely unforeseen and extraordinary calamity could have occurred between the time when he parted from his father, and the moment when, drawn back by his screams, he rushed into the glade? His slow, limping step and bowed shoulders gave the appearance of decrepitude, and yet his hard, deeplined, craggy features, and his enormous limbs showed that he was possessed of unusual strength of body and of character.\n",
      "\n",
      "\n",
      "Summary of Story 10:\n",
      "I began my operations at Gloucester Road Station, where a very helpful official walked with me along the track and allowed me to satisfy myself not only that the backstair windows of Caulfield Gardens open on the line but the even more essential fact that, owing to the intersection of one of the larger railways, the Underground trains are frequently held motionless for some minutes at that very spot. Heavily built and massive, there was a suggestion of uncouth physical inertia in the figure, but above this unwieldy frame there was perched a head so masterful in its brow, so alert in its steelgray, deepset eyes, so firm in its lips, and so subtle in its play of expression, that after the first glance one forgot the gross body and remembered only the dominant mind. But when, for the fourth time, after pushing back our chairs from breakfast we saw the greasy, heavy brown swirl still drifting past us and condensing in oily drops upon the windowpanes, my comrades impatient and active nature could endure this drab existence no longer. The only men worth considering are Adolph Mayer, of 13 Great George Street, Westminster Louis La Rothiere, of Campden Mansions, Notting Hill and Hugo Oberstein, 13 Caulfield Gardens, Kensington. It is a matter of historythat secret history of a nation which is often so much more intimate and interesting than its public chroniclesthat Oberstein, eager to complete the coup of his lifetime, came to the lure and was safely engulfed for fifteen years in a British prison.\n",
      "\n",
      "\n",
      "Summary of Story 11:\n",
      "I was dispatched, accordingly, in the troopship Orontes, and landed a month later on Portsmouth jetty, with my health irretrievably ruined, but with permission from a paternal government to spend the next nine months in attempting to improve it. I could imagine his giving a friend a little pinch of the latest vegetable alkaloid, not out of malevolence, you understand, but simply out of a spirit of inquiry in order to have an accurate idea of the effects. Mr.  Sherlock Holmes In the year 1878 I took my degree of Doctor of Medicine of the University of London, and proceeded to Netley to go through the course prescribed for surgeons in the army. I should have fallen into the hands of the murderous Ghazis had it not been for the devotion and courage shown by Murray, my orderly, who threw me across a packhorse, and succeeded in bringing me safely to the British lines. It was familiar ground to me, and I needed no guiding as we ascended the bleak stone staircase and made our way down the long corridor with its vista of whitewashed wall and duncoloured doors.\n",
      "\n",
      "\n",
      "Summary of Story 12:\n",
      "When a moment later I saw your eyes wander away from the picture, I suspected that your mind had now turned to the Civil War, and when I observed that your lips set, your eyes sparkled, and your hands clenched I was positive that you were indeed thinking of the gallantry which was shown by both sides in that desperate struggle. It is, however, unfortunately impossible entirely to separate the sensational from the criminal, and a chronicler is left in the dilemma that he must either sacrifice details which are essential to his statement and so give a false impression of the problem, or he must use matter which chance, and not choice, has provided him with. In choosing a few typical cases which illustrate the remarkable mental qualities of my friend, Sherlock Holmes, I have endeavoured, as far as possible, to select those which presented the minimum of sensationalism, while offering a fair field for his talents. You remember, said he, that some little time ago when I read you the passage in one of Poes sketches in which a close reasoner follows the unspoken thoughts of his companion, you were inclined to treat the matter as a mere tourdeforce of the author. The case, said Sherlock Holmes as we chatted over or cigars that night in our rooms at Baker Street, is one where, as in the investigations which you have chronicled under the names of A Study in Scarlet and of The Sign of Four, we have been compelled to reason backward from effects to causes.\n",
      "\n",
      "\n",
      "Summary of Story 13:\n",
      "Holmes lay with his gaunt figure stretched in his deep chair, his pipe curling forth slow wreaths of acrid tobacco, while his eyelids drooped over his eyes so lazily that he might almost have been asleep were it not that at any halt or questionable passage of my narrative they half lifted, and two gray eyes, as bright and keen as rapiers, transfixed me with their searching glance. It ran thus The remarkable acumen by which Inspector MacKinnon deduced from the smell of paint that some other smell, that of gas, for example, might be concealed the bold deduction that the strongroom might also be the deathchamber, and the subsequent inquiry which led to the discovery of the bodies in a disused well, cleverly concealed by a dogkennel, should live in the history of crime as a standing example of the intelligence of our professional detectives. Both police and coroner took a lenient view of the transaction, and beyond a mild censure for the delay in registering the ladys decease, the lucky owner got away scatheless from this strange incident in a career which has now outlived its shadows and promises to end in an honoured old age. When John Mason had left us, Holmes set to work making a very careful examination of the graves, ranging from a very ancient one, which appeared to be Saxon, in the centre, through a long line of Norman Hugos and Odos, until we reached the Sir William and Sir Denis Falder of the eighteenth century. The General phoned that all was ready, and the fiery Miss W.  turned up according to schedule, so that at halfpast five a cab deposited us outside 104 Berkeley Square, where the old soldier residesone of those awful gray London castles which would make a church seem frivolous.\n",
      "\n",
      "\n",
      "Summary of Story 14:\n",
      "As a flash of lightning in the night shows up in an instant every detail of a wide landscape, so at one glance I seemed to see every possible result of such an actionthe detection, the capture, the honoured career ending in irreparable failure and disgrace, my friend himself lying at the mercy of the odious Milverton. Charles Augustus Milverton was a man of fifty, with a large, intellectual head, a round, plump, hairless face, a perpetual frozen smile, and two keen grey eyes, which gleamed brightly from behind broad, goldenrimmed glasses. I have said that he is the worst man in London, and I would ask you how could one compare the ruffian who in hot blood bludgeons his mate with this man, who methodically and at his leisure tortures the soul and wrings the nerves in order to add to his already swollen moneybags? For a long time, even with the utmost discretion and reticence, it would have been impossible to make the facts public but now the principal person concerned is beyond the reach of human law, and with due suppression the story may be told in such fashion as to injure no one. It was a dark, handsome, clearcut face which confronted Milverton, a face with a curved nose, strong, dark eyebrows shading hard, glittering eyes, and a straight, thinlipped mouth set in a dangerous smile.\n",
      "\n",
      "\n",
      "Summary of Story 15:\n",
      "I was dispatched, accordingly, in the troopship Orontes, and landed a month later on Portsmouth jetty, with my health irretrievably ruined, but with permission from a paternal government to spend the next nine months in attempting to improve it. I could imagine his giving a friend a little pinch of the latest vegetable alkaloid, not out of malevolence, you understand, but simply out of a spirit of inquiry in order to have an accurate idea of the effects. Mr.  Sherlock Holmes In the year 1878 I took my degree of Doctor of Medicine of the University of London, and proceeded to Netley to go through the course prescribed for surgeons in the army. I should have fallen into the hands of the murderous Ghazis had it not been for the devotion and courage shown by Murray, my orderly, who threw me across a packhorse, and succeeded in bringing me safely to the British lines. It was familiar ground to me, and I needed no guiding as we ascended the bleak stone staircase and made our way down the long corridor with its vista of whitewashed wall and duncoloured doors.\n",
      "\n",
      "\n",
      "Summary of Story 16:\n",
      "You have erred, perhaps, he observed, taking up a glowing cinder with the tongs and lighting with it the long cherrywood pipe which was wont to replace his clay when he was in a disputatious rather than a meditative moodyou have erred perhaps in attempting to put colour and life into each of your statements instead of confining yourself to the task of placing upon record that severe reasoning from cause to effect which is really the only notable feature about the thing. It is pleasant to me to observe, Watson, that you have so far grasped this truth that in these little records of our cases which you have been good enough to draw up, and, I am bound to say, occasionally to embellish, you have given prominence not so much to the many causes célèbres and sensational trials in which I have figured but rather to those incidents which may have been trivial in themselves, but which have given room for those faculties of deduction and of logical synthesis which I have made my special province. There is no lane so vile that the scream of a tortured child, or the thud of a drunkards blow, does not beget sympathy and indignation among the neighbours, and then the whole machinery of justice is ever so close that a word of complaint can set it going, and there is but a step between the crime and the dock. A horrible doubt came into my mind as I approached the door lest the dog might be loose, but I remembered that Toller had drunk himself into a state of insensibility that evening, and I knew that he was the only one in the household who had any influence with the savage creature, or who would venture to set him free. As I stood in the passage gazing at the sinister door and wondering what secret it might veil, I suddenly heard the sound of steps within the room and saw a shadow pass backward and forward against the little slit of dim light which shone out from under the door.\n",
      "\n",
      "\n",
      "Summary of Story 17:\n",
      "In all our adventures I do not know that I have ever seen a more strange sight than this impassive and still dignified figure crouching froglike upon the ground and goading to a wilder exhibition of passion the maddened hound, which ramped and raged in front of him, by all manner of ingenious and calculated cruelty. Such a one on the back of a smart hansom swept us past a row of ancient colleges and, finally turning into a treelined drive, pulled up at the door of a charming house, girt round with lawns and covered with purple wisteria. He took handfuls of pebbles from the drive and threw them in the dogs face, prodded him with a stick which he had picked up, flicked his hands about only a few inches from the gaping mouth, and endeavoured in every way to increase the animals fury, which was already beyond all control. Mr.  Sherlock Holmes was always of opinion that I should publish the singular facts connected with Professor Presbury, if only to dispel once for all the ugly rumours which some twenty years ago agitated the university and were echoed in the learned societies of London. You may recollect that in the case which you, in your sensational way, coupled with the Copper Beeches, I was able, by watching the mind of the child, to form a deduction as to the criminal habits of the very smug and respectable father.\n",
      "\n",
      "\n",
      "Summary of Story 18:\n",
      "Mrs.  Barclay was, it appears, a member of the Roman Catholic Church, and had interested herself very much in the establishment of the Guild of St.  George, which was formed in connection with the Watt Street Chapel for the purpose of supplying the poor with castoff clothing. The blinds were not down, for the room was seldom used in the evening, but Mrs.  Barclay herself lit the lamp and then rang the bell, asking Jane Stewart, the housemaid, to bring her a cup of tea, which was quite contrary to her usual habits. His mistress had ceased to scream and was stretched insensible upon a couch, while with his feet tilted over the side of an armchair, and his head upon the ground near the corner of the fender, was lying the unfortunate soldier stone dead in a pool of his own blood. I took the obvious course, therefore, of calling upon Miss M. , of explaining to her that I was perfectly certain that she held the facts in her possession, and of assuring her that her friend, Mrs.  Barclay, might find herself in the dock upon a capital charge unless the matter were cleared up. It was commanded up to Monday night by James Barclay, a gallant veteran, who started as a full private, was raised to commissioned rank for his bravery at the time of the Mutiny, and so lived to command the regiment in which he had once carried a musket.\n",
      "\n",
      "\n",
      "Summary of Story 19:\n",
      "Yet there was much around to interest us, for we were passing through as singular a countryside as any in England, where a few scattered cottages represented the population of today, while on every hand enormous squaretowered churches bristled up from the flat, green landscape and told of the glory and prosperity of old East Anglia. A heavy step was heard upon the stairs, and an instant later there entered a tall, ruddy, cleanshaven gentleman, whose clear eyes and florid cheeks told of a life led far from the fogs of Baker Street. Would that I had some brighter ending to communicate to my readers, but these are the chronicles of fact, and I must follow to their dark crisis the strange chain of events which for some days made Ridling Thorpe Manor a household word through the length and breadth of England. The first message submitted to me was so short that it was impossible for me to do more than to say with some confidence that the symbol Picture Picture of a single dancing man stood for E.  As you are aware, E is the most common letter in the English alphabet, and it predominates to so marked an extent that even in a short sentence one would expect to find it most often. He was a tall, handsome, swarthy fellow, clad in a suit of grey flannel, with a Panama hat, a bristling black beard, and a great, aggressive hooked nose, and flourishing a cane as he walked.\n",
      "\n",
      "\n",
      "Summary of Story 20:\n",
      "The huge body, the craggy and deeply seamed face with the fierce eyes and hawklike nose, the grizzled hair which nearly brushed our cottage ceiling, the beardgolden at the fringes and white near the lips, save for the nicotine stain from his perpetual cigarall these were as well known in London as in Africa, and could only be associated with the tremendous personality of Dr.  Leon Sterndale, the great lionhunter and explorer. In March of that year Dr.  Moore Agar, of Harley Street, whose dramatic introduction to Holmes I may some day recount, gave positive injunctions that the famous private agent lay aside all his cases and surrender himself to complete rest if he wished to avert an absolute breakdown. From the windows of our little whitewashed house, which stood high upon a grassy headland, we looked down upon the whole sinister semicircle of Mounts Bay, that old death trap of sailing vessels, with its fringe of black cliffs and surgeswept reefs on which innumerable seamen have met their end. In every direction upon these moors there were traces of some vanished race which had passed utterly away, and left as it sole record strange monuments of stone, irregular mounds which contained the burned ashes of the dead, and curious earthworks which hinted at prehistoric strife. I have no idea what backward sweep of memory had brought the matter fresh to his mind, or what freak had caused him to desire that I should recount it but I hasten, before another cancelling telegram may arrive, to hunt out the notes which give me the exact details of the case and to lay the narrative before my readers.\n",
      "\n",
      "\n",
      "Summary of Story 21:\n",
      "His incredible untidiness, his addiction to music at strange hours, his occasional revolver practice within doors, his weird and often malodorous scientific experiments, and the atmosphere of violence and danger which hung around him made him the very worst tenant in London. Knowing how genuine was her regard for him, I listened earnestly to her story when she came to my rooms in the second year of my married life and told me of the sad condition to which my poor friend was reduced. Not only was her firstfloor flat invaded at all hours by throngs of singular and often undesirable characters but her remarkable lodger showed an eccentricity and irregularity in his life which must have sorely tried her patience. His eyes had the brightness of fever, there was a hectic flush upon either cheek, and dark crusts clung to his lips the thin hands upon the coverlet twitched incessantly, his voice was croaking and spasmodic. In the dim light of a foggy November day the sick room was a gloomy spot, but it was that gaunt, wasted face staring at me from the bed which sent a chill to my heart.\n",
      "\n",
      "\n",
      "Summary of Story 22:\n",
      "Meanwhile, come what may, Colonel Moran will trouble us no more, the famous airgun of Von Herder will embellish the Scotland Yard Museum, and once again Mr.  Sherlock Holmes is free to devote his life to examining those interesting little problems which the complex life of London so plentifully presents. I knew not what wild beast we were about to hunt down in the dark jungle of criminal London, but I was well assured from the bearing of this master huntsman that the adventure was a most grave one, while the sardonic smile which occasionally broke through his ascetic gloom boded little good for the object of our quest. It can be imagined that my close intimacy with Sherlock Holmes had interested me deeply in crime, and that after his disappearance I never failed to read with care the various problems which came before the public, and I even attempted more than once for my own private satisfaction to employ his methods in their solution, though with indifferent success. I left him an excellent mark in the window, and, having warned the police that they might be neededby the way, Watson, you spotted their presence in that doorway with unerring accuracyI took up what seemed to me to be a judicious post for observation, never dreaming that he would choose the same spot for his attack. Let me say to that public which has shown some interest in those glimpses which I have occasionally given them of the thoughts and actions of a very remarkable man that they are not to blame me if I have not shared my knowledge with them, for I should have considered it my first duty to have done so had I not been barred by a positive prohibition from his own lips, which was only withdrawn upon the third of last month.\n",
      "\n",
      "\n",
      "Summary of Story 23:\n",
      "The story has, I believe, been told more than once in the newspapers, but, like all such narratives, its effect is much less striking when set forth en bloc in a single halfcolumn of print than when the facts slowly evolve before your own eyes, and the mystery clears gradually away as each new discovery furnishes a step which leads on to the complete truth. Sherlock Holmes was, as I expected, lounging about his sittingroom in his dressinggown, reading the agony column of The Times and smoking his beforebreakfast pipe, which was composed of all the plugs and dottles left from his smokes of the day before, all carefully dried and collected on the corner of the mantelpiece. About sunset, however, their efforts were at last successful, and they subdued the flames, but not before the roof had fallen in, and the whole place been reduced to such absolute ruin that, save some twisted cylinders and iron piping, not a trace remained of the machinery which had cost our unfortunate acquaintance so dearly. Of these the latter may have afforded a finer field for an acute and original observer, but the other was so strange in its inception and so dramatic in its details that it may be the more worthy of being placed upon record, even if it gave my friend fewer openings for those deductive methods of reasoning by which he achieved such remarkable results. Early that morning a peasant had met a cart containing several people and some very bulky boxes driving rapidly in the direction of Reading, but there all traces of the fugitives disappeared, and even Holmes ingenuity failed ever to discover the least clue as to their whereabouts.\n",
      "\n",
      "\n",
      "Summary of Story 24:\n",
      "In an incoherent and, as I deeply feel, an entirely inadequate fashion, I have endeavored to give some account of my strange experiences in his company from the chance which first brought us together at the period of the Study in Scarlet, up to the time of his interference in the matter of the Naval Treatyan interference which had the unquestionable effect of preventing a serious international complication. During the winter of that year and the early spring of 1891, I saw in the papers that he had been engaged by the French government upon a matter of supreme importance, and I received two notes from Holmes, dated from Narbonne and from Nimes, from which I gathered that his stay in France was likely to be a long one. I knocked him down, and the police have him in custody but I can tell you with the most absolute confidence that no possible connection will ever be traced between the gentleman upon whose front teeth I have barked my knuckles and the retiring mathematical coach, who is, I dare say, working out problems upon a blackboard ten miles away. The shaft into which the river hurls itself is an immense chasm, lined by glistening coalblack rock, and narrowing into a creaming, boiling pit of incalculable depth, which brims over and shoots the stream onward over its jagged lip. On the 23d you incommoded me by the middle of February I was seriously inconvenienced by you at the end of March I was absolutely hampered in my plans and now, at the close of April, I find myself placed in such a position through your continual persecution that I am in positive danger of losing my liberty.\n",
      "\n",
      "\n",
      "Summary of Story 25:\n",
      "Among my headings under this one twelve months I find an account of the adventure of the Paradol Chamber, of the Amateur Mendicant Society, who held a luxurious club in the lower vault of a furniture warehouse, of the facts connected with the loss of the British barque Sophy Anderson, of the singular adventures of the Grice Patersons in the island of Uffa, and finally of the Camberwell poisoning case. All day the wind had screamed and the rain had beaten against the windows, so that even here in the heart of great, handmade London we were forced to raise our minds for the instant from the routine of life and to recognise the presence of those great elemental forces which shriek at mankind through the bars of his civilisation, like untamed beasts in a cage. Botany variable, geology profound as regards the mudstains from any region within fifty miles of town, chemistry eccentric, anatomy unsystematic, sensational literature and crime records unique, violinplayer, boxer, swordsman, lawyer, and selfpoisoner by cocaine and tobacco. Sherlock Holmes sat moodily at one side of the fireplace crossindexing his records of crime, while I at the other was deep in one of Clark Russells fine seastories until the howl of the gale from without seemed to blend with the text, and the splash of the rain to lengthen out into the long swash of the sea waves. Most of his time he would spend in his room, with the door locked upon the inside, but sometimes he would emerge in a sort of drunken frenzy and would burst out of the house and tear about the garden with a revolver in his hand, screaming out that he was afraid of no man, and that he was not to be cooped up, like a sheep in a pen, by man or devil.\n",
      "\n",
      "\n",
      "Summary of Story 26:\n",
      "It is in the form of a letter, and runs in this way My dear, dear son, now that approaching disgrace begins to darken the closing years of my life, I can write with all truth and honesty that it is not the terror of the law, it is not the loss of my position in the county, nor is it my fall in the eyes of all who have known me, which cuts me to the heart but it is the thought that you should come to blush for meyou who love me and who have seldom, I hope, had reason to do other than respect me. A splintered boat and a number of crates and fragments of spars rising and falling on the waves showed us where the vessel had foundered but there was no sign of life, and we had turned away in despair when we heard a cry for help, and saw at some distance a piece of wreckage with a man lying stretched across it. The sham chaplain came into our cells to exhort us, carrying a black bag, supposed to be full of tracts, and so often did he come that by the third day we had each stowed away at the foot of our beds a file, a brace of pistols, a pound of powder, and twenty slugs. The case might have been dealt leniently with, but the laws were more harshly administered thirty years ago than now, and on my twentythird birthday I found myself chained as a felon with thirtyseven other convicts in tweendecks of the bark Gloria Scott, bound for Australia. Then we rushed on into the captains cabin, but as we pushed open the door there was an explosion from within, and there he lay with his brains smeared over the chart of the Atlantic which was pinned upon the table, while the chaplain stood with a smoking pistol in his hand at his elbow.\n",
      "\n",
      "\n",
      "Summary of Story 27:\n",
      "He held them on his nose, endeavoured to read through them, went to the window and stared up the street with them, looked at them most minutely in the full light of the lamp, and finally, with a chuckle, seated himself at the table and wrote a few lines upon a sheet of paper, which he tossed across to Stanley Hopkins. The famous SmithMortimer succession case comes also within this period, and so does the tracking and arrest of Huret, the Boulevard assassinan exploit which won for Holmes an autograph letter of thanks from the French President and the Order of the Legion of Honour. Each of these would furnish a narrative, but on the whole I am of opinion that none of them unite so many singular points of interest as the episode of Yoxley Old Place, which includes not only the lamentable death of young Willoughby Smith, but also those subsequent developments which threw so curious a light upon the causes of the crime. When I look at the three massive manuscript volumes which contain our work for the year 1894 I confess that it is very difficult for me, out of such a wealth of material, to select the cases which are most interesting in themselves and at the same time most conducive to a display of those peculiar powers for which my friend was famous. We saw the cold winter sun rise over the dreary marshes of the Thames and the long, sullen reaches of the river, which I shall ever associate with our pursuit of the Andaman Islander in the earlier days of our career.\n",
      "\n",
      "\n",
      "Summary of Story 28:\n",
      "It was after tea on a summer evening, and the conversation, which had roamed in a desultory, spasmodic fashion from golf clubs to the causes of the change in the obliquity of the ecliptic, came round at last to the question of atavism and hereditary aptitudes. Finding that their secret was out, and that their prisoner was not to be coerced, the two villains with the girl had fled away at a few hours notice from the furnished house which they had hired, having first, as they thought, taken vengeance both upon the man who had defied and the one who had betrayed them. Sometimes the rattle of the stones told of a paved causeway, and at others our smooth, silent course suggested asphalt but, save by this variation in sound, there was nothing at all which could in the remotest way help me to form a guess as to where we were. Finally, finding him proof against every threat, they had hurled him back into his prison, and after reproaching Melas with his treachery, which appeared from the newspaper advertisement, they had stunned him with a blow from a stick, and he remembered nothing more until he found us bending over him. Melas, however, still lived, and in less than an hour, with the aid of ammonia and brandy I had the satisfaction of seeing him open his eyes, and of knowing that my hand had drawn him back from that dark valley in which all paths meet.\n",
      "\n",
      "\n",
      "Summary of Story 29:\n",
      "So your grave, middleaged family practitioner vanishes into thin air, my dear Watson, and there emerges a young fellow under thirty, amiable, unambitious, absentminded, and the possessor of a favourite dog, which I should describe roughly as being larger than a terrier and smaller than a mastiff. Now is the dramatic moment of fate, Watson, when you hear a step upon the stair which is walking into your life, and you know not whether for good or ill.  What does Dr.  James Mortimer, the man of science, ask of Sherlock Holmes, the specialist in crime? It is my experience that it is only an amiable man in this world who receives testimonials, only an unambitious one who abandons a London career for the country, and only an absentminded one who leaves his stick and not his visitingcard after waiting an hour in your room. He was a very tall, thin man, with a long nose like a beak, which jutted out between two keen, gray eyes, set closely together and sparkling brightly from behind a pair of goldrimmed glasses. I think, said I, following as far as I could the methods of my companion, that Dr.  Mortimer is a successful, elderly medical man, wellesteemed since those who know him give him this mark of their appreciation.\n",
      "\n",
      "\n",
      "Summary of Story 30:\n",
      "he continued, flushing up at the sight of the bitter sneer upon the mans face, it is not part of my duties to my client, but heres a hunting crop handy, and I think I shall just treat myself to He took two swift steps to the whip, but before he could grasp it there was a wild clatter of steps upon the stairs, the heavy hall door banged, and from the window we could see Mr.  James Windibank running at the top of his speed down the road. With the connivance and assistance of his wife he disguised himself, covered those keen eyes with tinted glasses, masked the face with a moustache and a pair of bushy whiskers, sunk that clear voice into an insinuating whisper, and doubly secure on account of the girls short sight, he appears as Mr.  Hosmer Angel, and keeps off other lovers by making love himself. If we could fly out of that window hand in hand, hover over this great city, gently remove the roofs, and peep in at the queer things which are going on, the strange coincidences, the plannings, the crosspurposes, the wonderful chains of events, working through generations, and leading to the most outré results, it would make all fiction with its conventionalities and foreseen conclusions most stale and unprofitable. Looking over his shoulder, I saw that on the pavement opposite there stood a large woman with a heavy fur boa round her neck, and a large curling red feather in a broadbrimmed hat which was tilted in a coquettish Duchess of Devonshire fashion over her ear. The husband was a teetotaler, there was no other woman, and the conduct complained of was that he had drifted into the habit of winding up every meal by taking out his false teeth and hurling them at his wife, which, you will allow, is not an action likely to occur to the imagination of the average storyteller.\n",
      "\n",
      "\n",
      "Summary of Story 31:\n",
      "The General phoned that all was ready, and the fiery Miss W.  turned up according to schedule, so that at halfpast five a cab deposited us outside 104 Berkeley Square, where the old soldier residesone of those awful gray London castles which would make a church seem frivolous. It was not possible for me to follow the immediate steps taken by my friend, for I had some pressing professional business of my own, but I met him by appointment that evening at Simpsons, where, sitting at a small table in the front window and looking down at the rushing stream of life in the Strand, he told me something of what had passed. It seems that he had dived down into what was peculiarly his kingdom, and beside him on the settee was a brand which he had brought up in the shape of a slim, flamelike young woman with a pale, intense face, youthful, and yet so worn with sin and sorrow that one read the terrible years which had left their leprous mark upon her. It was simply that among the passengers on the Cunard boat Ruritania, starting from Liverpool on Friday, was the Baron Adelbert Gruner, who had some important financial business to settle in the States before his impending wedding to Miss Violet de Merville, only daughter of, etc. The place had been built by a South African gold king in the days of the great boom, and the long, low house with the turrets at the corners, though an architectural nightmare, was imposing in its size and solidity.\n",
      "\n",
      "\n",
      "Summary of Story 32:\n",
      "His hand was on my throat and my senses were nearly gone before an unshaven French ouvrier in a blue blouse darted out from a cabaret opposite, with a cudgel in his hand, and struck my assailant a sharp crack over the forearm, which made him leave go his hold. Through the open sittingroom window I saw a huge, swarthy man with a bristling black beard walking slowly down the centre of the street and staring eagerly at he numbers of the houses. I left him smoking hard, with his heavy, dark brows knotted together, and his long, nervous fingers tapping upon the arms of his chair, as he turned over in his mind every possible solution of the mystery. She was left with limited means, but with some very remarkable old Spanish jewellery of silver and curiously cut diamonds to which she was fondly attachedtoo attached, for she refused to leave them with her banker and always carried them about with her. Her words were literally true, for we had hardly time to look around the dusty and motheaten apartment in which we found ourselves before the door opened and a big, cleanshaven baldheaded man stepped lightly into the room.\n",
      "\n",
      "\n",
      "Summary of Story 33:\n",
      "The two famous Germans stood beside the stone parapet of the garden walk, with the long, low, heavily gabled house behind them, and they looked down upon the broad sweep of the beach at the foot of the great chalk cliff in which Von Bork, like some wandering eagle, had perched himself four years before. When I say that I started my pilgrimage at Chicago, graduated in an Irish secret society at Buffalo, gave serious trouble to the constabulary at Skibbareen, and so eventually caught the eye of a subordinate agent of Von Bork, who recommended me as a likely man, you will realize that the matter was complex. The secretary lay back in the cushions of the luxurious limousine, with his thoughts so full of the impending European tragedy that he hardly observed that as his car swung round the village street it nearly passed over a little Ford coming in the opposite direction. With my hair cut and a few other superficial changes I shall no doubt reappear at Claridges tomorrow as I was before this American stuntI beg your pardon, Watson, my well of English seems to be permanently defiledbefore this American job came my way. One of these was his present companion, Baron Von Herling, the chief secretary of the legation, whose huge 100horsepower Benz car was blocking the country lane as it waited to waft its owner back to London.\n",
      "\n",
      "\n",
      "Summary of Story 34:\n",
      "Stackhurst was, of course, still there, and Ian Murdoch had just arrived with Anderson, the village constable, a big, gingermoustached man of the slow, solid Sussex breeda breed which covers much good sense under a heavy, silent exterior. My outer door was flung open, there were blundering footsteps in the passage, and Ian Murdoch staggered into the room, pallid, dishevelled, his clothes in wild disorder, clawing with his bony hands at the furniture to hold himself erect. Women have seldom been an attraction to me, for my brain has always governed my heart, but I could not look upon her perfect clearcut face, with all the soft freshness of the downlands in her delicate colouring, without realizing that no young man would cross her path unscathed. The multitudinous threads caused light scarlet lines upon the skin which on closer examination resolved into minute dots or pustules, each dot charged as it were with a redhot needle making its way through the nerves. Half a mile off, however, is Harold Stackhursts wellknown coaching establishment, The Gables, quite a large place, which contains some score of young fellows preparing for various professions, with a staff of several masters.\n",
      "\n",
      "\n",
      "Summary of Story 35:\n",
      "The telegram was a list of names and addresses Lord Harringby, The Dingle Sir George Ffolliott, Oxshott Towers Mr.  Hynes Hynes, J. P. , Purdley Place Mr.  James Baker Williams, Forton Old Hall Mr.  Henderson, High Gable Rev. There was a bustle outside, and Mrs.  Hudson opened the door to usher in two robust and officiallooking individuals, one of whom was well known to us as Inspector Gregson of Scotland Yard, an energetic, gallant, and, within his limitations, a capable officer. It was a cold, dark March evening, with a sharp wind and a fine rain beating upon our faces, a fit setting for the wild common over which our road passed and the tragic goal to which it led us. It is equally certain that this house cannot be more than a mile or two from Oxshott, since Garcia was walking in that direction and hoped, according to my reading of the facts, to be back in Wisteria Lodge in time to avail himself of an alibi, which would only be valid up to one oclock. Please arrange your thoughts and let me know, in their due sequence, exactly what those events are which have sent you out unbrushed and unkempt, with dress boots and waistcoat buttoned awry, in search of advice and assistance.\n",
      "\n",
      "\n",
      "Summary of Story 36:\n",
      "Finally, his eyes came round to the fresh and smiling face of Billy, the young but very wise and tactful page, who had helped a little to fill up the gap of loneliness and isolation which surrounded the saturnine figure of the great detective. The famous gameshot, sportsman, and manabouttown was a big, swarthy fellow, with a formidable dark moustache shading a cruel, thinlipped mouth, and surmounted by a long, curved nose like the beak of an eagle. The door opened to admit a thin, austere figure with a hatchet face and drooping midVictorian whiskers of a glossy blackness which hardly corresponded with the rounded shoulders and feeble gait. For an instant he half raised his loaded cane once more, as if he would turn his violence from the effigy to the original but there was something in that steady gray eye and mocking smile which caused his hand to sink to his side. He looked round him at the scientific charts upon the wall, the acidcharred bench of chemicals, the violincase leaning in the corner, the coalscuttle, which contained of old the pipes and tobacco.\n",
      "\n",
      "\n",
      "Summary of Story 37:\n",
      "It is in the form of a letter, and runs in this way My dear, dear son, now that approaching disgrace begins to darken the closing years of my life, I can write with all truth and honesty that it is not the terror of the law, it is not the loss of my position in the county, nor is it my fall in the eyes of all who have known me, which cuts me to the heart but it is the thought that you should come to blush for meyou who love me and who have seldom, I hope, had reason to do other than respect me. He had a horror of destroying documents, especially those which were connected with his past cases, and yet it was only once in every year or two that he would muster energy to docket and arrange them for, as I have mentioned somewhere in these incoherent memoirs, the outbursts of passionate energy when he performed the remarkable feats with which his name is associated were followed by reactions of lethargy during which he would lie about with his violin and his books, hardly moving save from the sofa to the table. Table of contents Silver Blaze The Yellow Face The StockBrokers Clerk The Gloria Scott The Musgrave Ritual The Reigate Squires The Crooked Man The Resident Patient The Greek Interpreter The Naval Treaty The Final Problem SILVER BLAZE I am afraid, Watson, that I shall have to go, said Holmes, as we sat down together to our breakfast one morning. There was a box of vestas, two inches of tallow candle, an A D P brierroot pipe, a pouch of sealskin with half an ounce of longcut Cavendish, a silver watch with a gold chain, five sovereigns in gold, an aluminum pencilcase, a few papers, and an ivoryhandled knife with a very delicate, inflexible blade marked Weiss Co. , London. It was clear, however, that Straker had defended himself vigorously against his assailants, for in his right hand he held a small knife, which was clotted with blood up to the handle, while in his left he clasped a red and black silk cravat, which was recognized by the maid as having been worn on the preceding evening by the stranger who had visited the stables.\n",
      "\n",
      "\n",
      "Summary of Story 38:\n",
      "As we had expected, the telegram was soon followed by its sender, and the card of Mr.  Cyril Overton, of Trinity College, Cambridge, announced the arrival of an enormous young man, sixteen stone of solid bone and muscle, who spanned the doorway with his broad shoulders and looked from one of us to the other with a comely face which was haggard with anxiety. Of course, I had at the outset no particular reason to connect these journeys with the disappearance of Godfrey Staunton, and was only inclined to investigate them on the general grounds that everything which concerns Dr.  Armstrong is at present of interest to us but, now that I find he keeps so keen a lookout upon anyone who may follow him on these excursions, the affair appears more important, and I shall not be satisfied until I have made the matter clear. Now I knew that under ordinary conditions he no longer craved for this artificial stimulus, but I was well aware that the fiend was not dead, but sleeping and I have known that the sleep was a light one and the waking near when in periods of idleness I have seen the drawn look upon Holmess ascetic face, and the brooding of his deepset and inscrutable eyes. I have wired to Overton to let us know any fresh London developments at this address, and in the meantime we can only concentrate our attention upon Dr.  Armstrong, whose name the obliging young lady at the office allowed me to read upon the counterfoil of Stauntons urgent message. We were fairly accustomed to receive weird telegrams at Baker Street, but I have a particular recollection of one which reached us on a gloomy February morning some seven or eight years ago and gave Mr.  Sherlock Holmes a puzzled quarter of an hour.\n",
      "\n",
      "\n",
      "Summary of Story 39:\n",
      "He had a horror of destroying documents, especially those which were connected with his past cases, and yet it was only once in every year or two that he would muster energy to docket and arrange them for, as I have mentioned somewhere in these incoherent memoirs, the outbursts of passionate energy when he performed the remarkable feats with which his name is associated were followed by reactions of lethargy during which he would lie about with his violin and his books, hardly moving save from the sofa to the table. I have always held, too, that pistol practice should be distinctly an openair pastime and when Holmes, in one of his queer humors, would sit in an armchair with his hairtrigger and a hundred Boxer cartridges, and proceed to adorn the opposite wall with a patriotic V.  R.  done in bulletpocks, I felt strongly that neither the atmosphere nor the appearance of our room was improved by it. An anomaly which often struck me in the character of my friend Sherlock Holmes was that, although in his methods of thought he was the neatest and most methodical of mankind, and although also he affected a certain quiet primness of dress, he was none the less in his personal habits one of the most untidy men that ever drove a fellowlodger to distraction. Be that as it might, I seemed to see that womans figure still clutching at her treasure trove and flying wildly up the winding stair, with her ears ringing perhaps with the muffled screams from behind her and with the drumming of frenzied hands against the slab of stone which was choking her faithless lovers life out. Evidently, as they had dragged the stone up they had thrust the chunks of wood into the chink, until at last, when the opening was large enough to crawl through, they would hold it open by a billet placed lengthwise, which might very well become indented at the lower end, since the whole weight of the stone would press it down on to the edge of this other slab.\n",
      "\n",
      "\n",
      "Summary of Story 40:\n",
      "When I heard that some one had been so anxious to get into the bedroom, in which no one but Joseph could have concealed anythingyou told us in your narrative how you had turned Joseph out when you arrived with the doctormy suspicions all changed to certainties, especially as the attempt was made on the first night upon which the nurse was absent, showing that the intruder was well acquainted with the ways of the house. After leaving you at the station I went for a charming walk through some admirable Surrey scenery to a pretty little village called Ripley, where I had my tea at an inn, and took the precaution of filling my flask and of putting a paper of sandwiches in my pocket. I still retain an almost verbatim report of the interview in which he demonstrated the true facts of the case to Monsieur Dubugue of the Paris police, and Fritz von Waldbaum, the wellknown specialist of Dantzig, both of whom had wasted their energies upon what proved to be sideissues. He made his way to Woking by the first train, and having examined his booty and assured himself that it really was of immense value, he had concealed it in what he thought was a very safe place, with the intention of taking it out again in a day or two, and carrying it to the French embassy, or wherever he thought that a long price was to be had. Without going into details, I may say that it defined the position of Great Britain towards the Triple Alliance, and foreshadowed the policy which this country would pursue in the event of the French fleet gaining a complete ascendancy over that of Italy in the Mediterranean.\n",
      "\n",
      "\n",
      "Summary of Story 41:\n",
      "When he told us of a man in a pew, of the change in the brides manner, of so transparent a device for obtaining a note as the dropping of a bouquet, of her resort to her confidential maid, and of her very significant allusion to claimjumpingwhich in miners parlance means taking possession of that which another person has a prior claim tothe whole situation became absolutely clear. As it is an open secret that the Duke of Balmoral has been compelled to sell his pictures within the last few years, and as Lord St.  Simon has no property of his own save the small estate of Birchmoor, it is obvious that the Californian heiress is not the only gainer by an alliance which will enable her to make the easy and common transition from a Republican lady to a British peeress. The ceremony, which was performed at St.  Georges, Hanover Square, was a very quiet one, no one being present save the father of the bride, Mr.  Aloysius Doran, the Duchess of Balmoral, Lord Backwater, Lord Eustace and Lady Clara St.  Simon the younger brother and sister of the bridegroom, and Lady Alicia Whittington. His letters were to be forwarded to 226 Gordon Square so thither I travelled, and being fortunate enough to find the loving couple at home, I ventured to give them some paternal advice and to point out to them that it would be better in every way that they should make their position a little clearer both to the general public and to Lord St.  Simon in particular. Then there is another note in the Morning Post to say that the marriage would be an absolutely quiet one, that it would be at St.  Georges, Hanover Square, that only half a dozen intimate friends would be invited, and that the party would return to the furnished house at Lancaster Gate which has been taken by Mr.  Aloysius Doran.\n",
      "\n",
      "\n",
      "Summary of Story 42:\n",
      "It is known that Mr.  Jonas Oldacre had received a late visitor in his bedroom upon that night, and the stick found has been identified as the property of this person, who is a young London solicitor named John Hector McFarlane, junior partner of Graham and McFarlane, of 426, Gresham Buildings, E. C.  The police believe that they have evidence in their possession which supplies a very convincing motive for the crime, and altogether it cannot be doubted that sensational developments will follow. Mr.  Sherlock Holmes was leaning back in his chair after his whimsical protest, and was unfolding his morning paper in a leisurely fashion, when our attention was arrested by a tremendous ring at the bell, followed immediately by a hollow drumming sound, as if someone were beating on the outer door with his fist. A young doctor, named Verner, had purchased my small Kensington practice, and given with astonishingly little demur the highest price that I ventured to askan incident which only explained itself some years later when I found that Verner was a distant relation of Holmess, and that it was my friend who had really found the money. Besides the signs of a struggle in the room of the unfortunate builder it is now known that the French windows of his bedroom which is on the ground floor were found to be open, that there were marks as if some bulky object had been dragged across to the woodpile, and, finally, it is asserted that charred remains have been found among the charcoal ashes of the fire. An examination of his room revealed that the bed had not been slept in, that a safe which stood in it was open, that a number of important papers were scattered about the room, and, finally, that there were signs of a murderous struggle, slight traces of blood being found within the room, and an oaken walkingstick, which also showed stains of blood upon the handle.\n",
      "\n",
      "\n",
      "Summary of Story 43:\n",
      "But I felt that my school had reached its zenith when, three weeks ago, the Duke of Holdernesse sent Mr.  James Wilder, his secretary, with the intimation that young Lord Saltire, ten years old, his only son and heir, was about to be committed to my charge. It was evident that to his intensely aristocratic nature this discussion of his intimate family affairs with a stranger was most abhorrent, and that he feared lest every fresh question would throw a fiercer light into the discreetly shadowed corners of his ducal history. At the spot where we saw the last of the Dunlop tyre it might equally have led to Holdernesse Hall, the stately towers of which rose some miles to our left, or to a low, grey village which lay in front of us, and marked the position of the Chesterfield high road. He had obtained a large ordnance map of the neighbourhood, and this he brought into my room, where he laid it out on the bed, and, having balanced the lamp in the middle of it, he began to smoke over it, and occasionally to point out objects of interest with the reeking amber of his pipe. And now, Dr.  Huxtable, when you have consumed that milk you will kindly tell me what has happened, when it happened, how it happened, and, finally, what Dr.  Thorneycroft Huxtable, of the Priory School, near Mackleton, has to do with the matter, and why he comes three days after an eventthe state of your chin gives the dateto ask for my humble services.\n",
      "\n",
      "\n",
      "Summary of Story 44:\n",
      "When we returned to Mrs.  Warrens rooms, the gloom of a London winter evening had thickened into one gray curtain, a dead monotone of colour, broken only by the sharp yellow squares of the windows and the blurred haloes of the gaslamps. Halloa, what on earth The light had suddenly gone out, the glimmering square of window had disappeared, and the third floor formed a dark band round the lofty building, with its tiers of shining casements. Suddenly, as the landladys footsteps died away, there was the creak of a turning key, the handle revolved, and two thin hands darted out and lifted the tray form the chair. At halfpast twelve we found ourselves upon the steps of Mrs.  Warrens housea high, thin, yellowbrick edifice in Great Orme Street, a narrow thoroughfare at the northeast side of the British Museum. An instant later it was hurriedly replaced, and I caught a glimpse of a dark, beautiful, horrified face glaring at the narrow opening of the boxroom.\n",
      "\n",
      "\n",
      "Summary of Story 45:\n",
      "My limbs were weary and stiff, for I feared to change my position yet my nerves were worked up to the highest pitch of tension, and my hearing was so acute that I could not only hear the gentle breathing of my companions, but I could distinguish the deeper, heavier inbreath of the bulky Jones from the thin, sighing note of the bank director. All the afternoon he sat in the stalls wrapped in the most perfect happiness, gently waving his long, thin fingers in time to the music, while his gently smiling face and his languid, dreamy eyes were as unlike those of Holmes the sleuthhound, Holmes the relentless, keenwitted, readyhanded criminal agent, as it was possible to conceive. You see, Watson, he explained in the early hours of the morning as we sat over a glass of whisky and soda in Baker Street, it was perfectly obvious from the first that the only possible object of this rather fantastic business of the advertisement of the League, and the copying of the Encyclopaedia, must be to get this not overbright pawnbroker out of the way for a number of hours every day. It was a poky, little, shabbygenteel place, where four lines of dingy twostoried brick houses looked out into a small railedin enclosure, where a lawn of weedy grass and a few clumps of faded laurelbushes made a hard fight against a smokeladen and uncongenial atmosphere. He wore rather baggy grey shepherds check trousers, a not overclean black frockcoat, unbuttoned in the front, and a drab waistcoat with a heavy brassy Albert chain, and a square pierced bit of metal dangling down as an ornament.\n",
      "\n",
      "\n",
      "Summary of Story 46:\n",
      "The whole place was turned upside down, drawers burst open, and presses ransacked, with the result that an odd volume of Popes Homer, two plated candlesticks, an ivory letterweight, a small oak barometer, and a ball of twine are all that have vanished. In this case, looking at the bold, strong hand of the one, and the rather brokenbacked appearance of the other, which still retains its legibility although the ts have begun to lose their crossing, we can say that the one was a young man and the other was advanced in years without being positively decrepit. Before going into this, I would draw your attention to the fact that, if Alec Cunninghams narrative was correct, and if the assailant, after shooting William Kirwan, had instantly fled, then it obviously could not be he who tore the paper from the dead mans hand. Picture Scrap showing the words At quarter to twelve, learn what, may be Presuming that it is an appointment, continued the Inspector, it is of course a conceivable theory that this William Kirwanthough he had the reputation of being an honest man, may have been in league with the thief. We passed the pretty cottage where the murdered man had lived, and walked up an oaklined avenue to the fine old Queen Anne house, which bears the date of Malplaquet upon the lintel of the door.\n",
      "\n",
      "\n",
      "Summary of Story 47:\n",
      "After I had graduated I continued to devote myself to research, occupying a minor position in Kings College Hospital, and I was fortunate enough to excite considerable interest by my research into the pathology of catalepsy, and finally to win the Bruce Pinkerton prize and medal by the monograph on nervous lesions to which your friend has just alluded. I was sufficiently conversant with Holmess methods to be able to follow his reasoning, and to see that the nature and state of the various medical instruments in the wicker basket which hung in the lamplight inside the brougham had given him the data for his swift deduction. Glancing over the somewhat incoherent series of Memoirs with which I have endeavored to illustrate a few of the mental peculiarities of my friend Mr.  Sherlock Holmes, I have been struck by the difficulty which I have experienced in picking out examples which shall in every way answer my purpose. From that night nothing has been seen of the three murderers by the police, and it is surmised at Scotland Yard that they were among the passengers of the illfated steamer Norah Creina, which was lost some years ago with all hands upon the Portuguese coast, some leagues to the north of Oporto. It was boisterous October weather, and we had both remained indoors all day, I because I feared with my shaken health to face the keen autumn wind, while he was deep in some of those abstruse chemical investigations which absorbed him utterly as long as he was engaged upon them.\n",
      "\n",
      "\n",
      "Summary of Story 48:\n",
      "Holmes lay with his gaunt figure stretched in his deep chair, his pipe curling forth slow wreaths of acrid tobacco, while his eyelids drooped over his eyes so lazily that he might almost have been asleep were it not that at any halt or questionable passage of my narrative they half lifted, and two gray eyes, as bright and keen as rapiers, transfixed me with their searching glance. It ran thus The remarkable acumen by which Inspector MacKinnon deduced from the smell of paint that some other smell, that of gas, for example, might be concealed the bold deduction that the strongroom might also be the deathchamber, and the subsequent inquiry which led to the discovery of the bodies in a disused well, cleverly concealed by a dogkennel, should live in the history of crime as a standing example of the intelligence of our professional detectives. Right in the middle of them, a little island of ancient culture and comfort, lies this old home, surrounded by a high sunbaked wall mottled with lichens and topped with moss, the sort of wall Cut out the poetry, Watson, said Holmes severely. My remembrance of the journey is not a pleasant one, for the weather was hot, the train slow, and my companion sullen and silent, hardly talking at all save to make an occasional sardonic remark as to the futility of our proceedings. The house, too, was slatternly to the last degree, but the poor man seemed himself to be aware of it and to be trying to remedy it, for a great pot of green paint stood in the centre of the hall, and he was carrying a thick brush in his left hand.\n",
      "\n",
      "\n",
      "Summary of Story 49:\n",
      "It is known that Mr.  Jonas Oldacre had received a late visitor in his bedroom upon that night, and the stick found has been identified as the property of this person, who is a young London solicitor named John Hector McFarlane, junior partner of Graham and McFarlane, of 426, Gresham Buildings, E. C.  The police believe that they have evidence in their possession which supplies a very convincing motive for the crime, and altogether it cannot be doubted that sensational developments will follow. Yes, gentlemen, said he, it is the most famous pearl now existing in the world, and it has been my good fortune, by a connected chain of inductive reasoning, to trace it from the Prince of Colonnas bedroom at the Dacre Hotel, where it was lost, to the interior of this, the last of the six busts of Napoleon which were manufactured by Gelder Co.  You will remember, Lestrade, the sensation caused by the disappearance of this valuable jewel, and the vain efforts of the London police to recover it. His reasons for destroying the busts were still unknown, and he refused to answer any questions upon the subject but the police had discovered that these same busts might very well have been made by his own hands, since he was engaged in this class of work at the establishment of Gelder Co.  To all this information, much of which we already knew, Holmes listened with polite attention but I, who knew him so well, could clearly see that his thoughts were elsewhere, and I detected a mixture of mingled uneasiness and expectation beneath that mask which he was wont to assume. The household of the Abbey Grange were much surprised at our return, but Sherlock Holmes, finding that Stanley Hopkins had gone off to report to headquarters, took possession of the diningroom, locked the door upon the inside, and devoted himself for two hours to one of those minute and laborious investigations which formed the solid basis on which his brilliant edifices of deduction were reared. As we had expected, the telegram was soon followed by its sender, and the card of Mr.  Cyril Overton, of Trinity College, Cambridge, announced the arrival of an enormous young man, sixteen stone of solid bone and muscle, who spanned the doorway with his broad shoulders and looked from one of us to the other with a comely face which was haggard with anxiety.\n",
      "\n",
      "\n",
      "Summary of Story 50:\n",
      "My own complete happiness, and the homecentred interests which rise up around the man who first finds himself master of his own establishment, were sufficient to absorb all my attention, while Holmes, who loathed every form of society with his whole Bohemian soul, remained in our lodgings in Baker Street, buried among his old books, and alternating from week to week between cocaine and ambition, the drowsiness of the drug, and the fierce energy of his own keen nature. From time to time I heard some vague account of his doings of his summons to Odessa in the case of the Trepoff murder, of his clearing up of the singular tragedy of the Atkinson brothers at Trincomalee, and finally of the mission which he had accomplished so delicately and successfully for the reigning family of Holland. Heavy bands of astrakhan were slashed across the sleeves and fronts of his doublebreasted coat, while the deep blue cloak which was thrown over his shoulders was lined with flamecoloured silk and secured at the neck with a brooch which consisted of a single flaming beryl. As to your practice, if a gentleman walks into my rooms smelling of iodoform, with a black mark of nitrate of silver upon his right forefinger, and a bulge on the right side of his tophat to show where he has secreted his stethoscope, I must be dull, indeed, if I do not pronounce him to be an active member of the medical profession. He was still, as ever, deeply attracted by the study of crime, and occupied his immense faculties and extraordinary powers of observation in following out those clues, and clearing up those mysteries which had been abandoned as hopeless by the official police.\n",
      "\n",
      "\n",
      "Summary of Story 51:\n",
      "It was only upon my representing to him that I had given a promise that The Adventure of the Second Stain should be published when the times were ripe, and pointing out to him that it is only appropriate that this long series of episodes should culminate in the most important international case which he has ever been called upon to handle, that I at last succeeded in obtaining his consent that a carefullyguarded account of the incident should at last be laid before the public. You will be relieved to hear that there will be no war, that the Right Honourable Trelawney Hope will suffer no setback in his brilliant career, that the indiscreet Sovereign will receive no punishment for his indiscretion, that the Prime Minister will have no European complication to deal with, and that with a little tact and management upon our part nobody will be a penny the worse for what might have been a very ugly incident. This was the paragraph which I had been engaged in reading when he rose from his chair Murder in Westminster A crime of mysterious character was committed last night at 16, Godolphin Street, one of the oldfashioned and secluded rows of eighteenthcentury houses which lie between the river and the Abbey, almost in the shadow of the great Tower of the Houses of Parliament. So long as he was in actual professional practice the records of his successes were of some practical value to him but since he has definitely retired from London and betaken himself to study and beefarming on the Sussex Downs, notoriety has become hateful to him, and he has peremptorily requested that his wishes in this matter should be strictly observed. A discovery has just been made by the Parisian police said the Daily Telegraph which raises the veil which hung round the tragic fate of Mr.  Eduardo Lucas, who met his death by violence last Monday night at Godolphin Street, Westminster.\n",
      "\n",
      "\n",
      "Summary of Story 52:\n",
      "Both police and coroner took a lenient view of the transaction, and beyond a mild censure for the delay in registering the ladys decease, the lucky owner got away scatheless from this strange incident in a career which has now outlived its shadows and promises to end in an honoured old age. When John Mason had left us, Holmes set to work making a very careful examination of the graves, ranging from a very ancient one, which appeared to be Saxon, in the centre, through a long line of Norman Hugos and Odos, until we reached the Sir William and Sir Denis Falder of the eighteenth century. In the glare of the lantern I saw a body swathed in a sheet from head to foot, with dreadful, witchlike features, all nose and chin, projecting at one end, the dim, glazed eyes staring from a discoloured and crumbling face. Shoscombe Prince did win the Derby, the sporting owner did net eighty thousand pounds in bets, and the creditors did hold their hand until the race was over, when they were paid in full, and enough was left to reestablish Sir Robert in a fair position in life. Striking a match, he illuminated the melancholy placedismal and evilsmelling, with ancient crumbling walls of roughhewn stone, and piles of coffins, some of lead and some of stone, extending upon one side right up to the arched and groined roof which lost itself in the shadows above our heads.\n",
      "\n",
      "\n",
      "Summary of Story 53:\n",
      "He was left with good prospects, but he threw away his chances, lived for some time in poverty with occasional short intervals of prosperity, and finally, taking to drink, he died. I handed him over the watch with some slight feeling of amusement in my heart, for the test was, as I thought, an impossible one, and I intended it as a lesson against the somewhat dogmatic tone which he occasionally assumed. When you observe the lower part of that watchcase you notice that it is not only dinted in two places, but it is cut and marked all over from the habit of keeping other hard objects, such as coins or keys, in the same pocket. Just opposite the Seymour Street Office they have taken up the pavement and thrown up some earth which lies in such a way that it is difficult to avoid treading in it in entering. Here, too, is a curious little work upon the influence of a trade upon the form of the hand, with lithotypes of the hands of slaters, sailors, corkcutters, compositors, weavers, and diamondpolishers.\n",
      "\n",
      "\n",
      "Summary of Story 54:\n",
      "There was a box of vestas, two inches of tallow candle, an A D P brierroot pipe, a pouch of sealskin with half an ounce of longcut Cavendish, a silver watch with a gold chain, five sovereigns in gold, an aluminum pencilcase, a few papers, and an ivoryhandled knife with a very delicate, inflexible blade marked Weiss Co. , London. It was clear, however, that Straker had defended himself vigorously against his assailants, for in his right hand he held a small knife, which was clotted with blood up to the handle, while in his left he clasped a red and black silk cravat, which was recognized by the maid as having been worn on the preceding evening by the stranger who had visited the stables. Two gentlemen were awaiting us in the stationthe one a tall, fair man with lionlike hair and beard and curiously penetrating light blue eyes the other a small, alert person, very neat and dapper, in a frockcoat and gaiters, with trim little sidewhiskers and an eyeglass. And so it happened that an hour or so later I found myself in the corner of a firstclass carriage flying along en route for Exeter, while Sherlock Holmes, with his sharp, eager face framed in his earflapped travellingcap, dipped rapidly into the bundle of fresh papers which he had procured at Paddington. We had the corner of a Pullman car to ourselves that evening as we whirled back to London, and I fancy that the journey was a short one to Colonel Ross as well as to myself, as we listened to our companions narrative of the events which had occurred at the Dartmoor trainingstables upon the Monday night, and the means by which he had unravelled them.\n",
      "\n",
      "\n",
      "Summary of Story 55:\n",
      "Yes, gentlemen, said he, it is the most famous pearl now existing in the world, and it has been my good fortune, by a connected chain of inductive reasoning, to trace it from the Prince of Colonnas bedroom at the Dacre Hotel, where it was lost, to the interior of this, the last of the six busts of Napoleon which were manufactured by Gelder Co.  You will remember, Lestrade, the sensation caused by the disappearance of this valuable jewel, and the vain efforts of the London police to recover it. His reasons for destroying the busts were still unknown, and he refused to answer any questions upon the subject but the police had discovered that these same busts might very well have been made by his own hands, since he was engaged in this class of work at the establishment of Gelder Co.  To all this information, much of which we already knew, Holmes listened with polite attention but I, who knew him so well, could clearly see that his thoughts were elsewhere, and I detected a mixture of mingled uneasiness and expectation beneath that mask which he was wont to assume. Listen to this It is satisfactory to know that there can be no difference of opinion upon this case, since Mr.  Lestrade, one of the most experienced members of the official force, and Mr.  Sherlock Holmes, the wellknown consulting expert, have each come to the conclusion that the grotesque series of incidents, which have ended in so tragic a fashion, arise from lunacy rather than from deliberate crime. In return for the news which Lestrade would bring, Holmes was always ready to listen with attention to the details of any case upon which the detective was engaged, and was able occasionally, without any active interference, to give some hint or suggestion drawn from his own vast knowledge and experience. For my own part, I had followed step by step the methods by which he had traced the various windings of this complex case, and, though I could not yet perceive the goal which we would reach, I understood clearly that Holmes expected this grotesque criminal to make an attempt upon the two remaining busts, one of which, I remembered, was at Chiswick.\n",
      "\n",
      "\n",
      "Summary of Story 56:\n",
      "I begin to think so, Mr.  Holmes but when I thought of all the precaution I had taken to shield this girlfor I loved her, Mr.  Holmes, and it is the only time that ever I knew what love wasit fairly drove me mad to think that she was in the power of the greatest brute and bully in South Africa, a man whose name is a holy terror from Kimberley to Johannesburg. Next morning we had a note from Miss Smith, recounting shortly and accurately the very incidents which I had seen, but the pith of the letter lay in the postscript I am sure that you will respect my confidence, Mr.  Holmes, when I tell you that my place here has become difficult owing to the fact that my employer has proposed marriage to me. Holmess quiet day in the country had a singular termination, for he arrived at Baker Street late in the evening with a cut lip and a discoloured lump upon his forehead, besides a general air of dissipation which would have made his own person the fitting object of a Scotland Yard investigation. I find, however, a short note at the end of my manuscripts dealing with this case, in which I have put it upon record that Miss Violet Smith did indeed inherit a large fortune, and that she is now the wife of Cyril Morton, the senior partner of Morton Kennedy, the famous Westminster electricians. Between them an elderly, greybearded man, wearing a short surplice over a light tweed suit, had evidently just completed the wedding service, for he pocketed his prayerbook as we appeared and slapped the sinister bridegroom upon the back in jovial congratulation.\n",
      "\n",
      "\n",
      "Summary of Story 57:\n",
      "When you combine the ideas of whistles at night, the presence of a band of gipsies who are on intimate terms with this old doctor, the fact that we have every reason to believe that the doctor has an interest in preventing his stepdaughters marriage, the dying allusion to a band, and, finally, the fact that Miss Helen Stoner heard a metallic clang, which might have been caused by one of those metal bars that secured the shutters falling back into its place, I think that there is good ground to think that the mystery may be cleared along those lines. It is not necessary that I should prolong a narrative which has already run to too great a length by telling how we broke the sad news to the terrified girl, how we conveyed her by the morning train to the care of her good aunt at Harrow, of how the slow process of official inquiry came to the conclusion that the doctor met his fate while indiscreetly playing with a dangerous pet. On glancing over my notes of the seventy odd cases in which I have during the last eight years studied the methods of my friend Sherlock Holmes, I find many tragic, some comic, a large number merely strange, but none commonplace for, working as he did rather for the love of his art than for the acquirement of wealth, he refused to associate himself with any investigation which did not tend towards the unusual, and even the fantastic. The last squire dragged out his existence there, living the horrible life of an aristocratic pauper but his only son, my stepfather, seeing that he must adapt himself to the new conditions, obtained an advance from a relative, which enabled him to take a medical degree and went out to Calcutta, where, by his professional skill and his force of character, he established a large practice. A large face, seared with a thousand wrinkles, burned yellow with the sun, and marked with every evil passion, was turned from one to the other of us, while his deepset, bileshot eyes, and his high, thin, fleshless nose, gave him somewhat the resemblance to a fierce old bird of prey.\n",
      "\n",
      "\n",
      "Summary of Story 58:\n",
      "He wore a very shiny top hat and a neat suit of sober black, which made him look what he wasa smart young City man, of the class who have been labeled cockneys, but who give us our crack volunteer regiments, and who turn out more fine athletes and sportsmen than any body of men in these islands. Im not very good at telling a story, Dr.  Watson, but it is like this with me I used to have a billet at Coxon Woodhouses, of Drapers Gardens, but they were let in early in the spring through the Venezuelan loan, as no doubt you remember, and came a nasty cropper. I had thought of a great office with shining tables and rows of clerks, such as I was used to, and I dare say I stared rather straight at the two deal chairs and one little table, which, with a ledger and a waste paper basket, made up the whole furniture. I was surprised, therefore, when, one morning in June, as I sat reading the British Medical Journal after breakfast, I heard a ring at the bell, followed by the high, somewhat strident tones of my old companions voice. It appeared from its position in the paper to have been the one event of importance in town, and the account of it ran in this way A desperate attempt at robbery, culminating in the death of one man and the capture of the criminal, occurred this afternoon in the City.\n",
      "\n",
      "\n",
      "Summary of Story 59:\n",
      "I was dispatched, accordingly, in the troopship Orontes, and landed a month later on Portsmouth jetty, with my health irretrievably ruined, but with permission from a paternal government to spend the next nine months in attempting to improve it. I could imagine his giving a friend a little pinch of the latest vegetable alkaloid, not out of malevolence, you understand, but simply out of a spirit of inquiry in order to have an accurate idea of the effects. Mr.  Sherlock Holmes In the year 1878 I took my degree of Doctor of Medicine of the University of London, and proceeded to Netley to go through the course prescribed for surgeons in the army. I should have fallen into the hands of the murderous Ghazis had it not been for the devotion and courage shown by Murray, my orderly, who threw me across a packhorse, and succeeded in bringing me safely to the British lines. It was familiar ground to me, and I needed no guiding as we ascended the bleak stone staircase and made our way down the long corridor with its vista of whitewashed wall and duncoloured doors.\n",
      "\n",
      "\n",
      "Summary of Story 60:\n",
      "They were ornamented, however, on the lower part by a line of wellchosen modern watercolours while above, where yellow plaster took the place of oak, there was hung a fine collection of South American utensils and weapons, which had been brought, no doubt, by the Peruvian lady upstairs. It was evening of a dull, foggy November day when, having left our bags at the Chequers, Lamberley, we drove through the Sussex clay of a long winding lane and finally reached the isolated and ancient farmhouse in which Ferguson dwelt. Re Vampires Sir Referring to your letter of the 19th, I beg to state that I have looked into the inquiry of your client, Mr.  Robert Ferguson, of Ferguson and Muirhead, tea brokers, of Mincing Lane, and that the matter has been brought to a satisfactory conclusion. The lady was very beautiful, but the fact of her foreign birth and of her alien religion always caused a separation of interests and of feelings between husband and wife, so that after a time his love may have cooled towards her and he may have come to regard their union as a mistake. Presently he returned, and behind him came a tall, gaunt woman bearing in her arms a very beautiful child, darkeyed, goldenhaired, a wonderful mixture of the Saxon and the Latin.\n",
      "\n",
      "\n",
      "Summary of Story 61:\n",
      "I would not wish to wrong her, but she loved so vividly in a physical sense that she could hardly understand the mental, and even spiritual, tie which held her husband to me, or imagine that it was only my desire to influence his power to good ends which kept me under his roof. Do you tell me that after carrying out so crafty a crime you would now ruin your reputation as a criminal by forgetting to fling your weapon into those adjacent reedbeds which would forever cover it, but you must needs carry it carefully home and put it in your own wardrobe, the very first place that would be searched? Suddenly, however, as we neared our destination he seated himself opposite to mewe had a firstclass carriage to ourselvesand laying a hand upon each of my knees he looked into my eyes with the peculiarly mischievous gaze which was characteristic of his more implike moods. A third case worthy of note is that of Isadora Persano, the wellknown journalist and duellist, who was found stark staring mad with a match box in front of him which contained a remarkable worm said to be unknown to science. We were compelled to spend the night at Winchester, as the formalities had not yet been completed, but next morning, in the company of Mr.  Joyce Cummings, the rising barrister who was entrusted with the defence, we were allowed to see the young lady in her cell.\n",
      "\n",
      "\n",
      "Summary of Story 62:\n",
      "A shock of orange hair, a pale face disfigured by a horrible scar, which, by its contraction, has turned up the outer edge of his upper lip, a bulldog chin, and a pair of very penetrating dark eyes, which present a singular contrast to the colour of his hair, all mark him out from amid the common crowd of mendicants and so, too, does his wit, for he is ever ready with a reply to any piece of chaff which may be thrown at him by the passersby. Ordering my cab to wait, I passed down the steps, worn hollow in the centre by the ceaseless tread of drunken feet and by the light of a flickering oillamp above the door I found the latch and made my way into a long, low room, thick and heavy with the brown opium smoke, and terraced with wooden berths, like the forecastle of an emigrant ship. Through the gloom one could dimly catch a glimpse of bodies lying in strange fantastic poses, bowed shoulders, bent knees, heads thrown back, and chins pointing upward, with here and there a dark, lacklustre eye turned upon the newcomer. In the dim light of the lamp I saw him sitting there, an old briar pipe between his lips, his eyes fixed vacantly upon the corner of the ceiling, the blue smoke curling up from him, silent, motionless, with the light shining upon his strongset aquiline features. Holmes drove in silence, with his head sunk upon his breast, and the air of a man who is lost in thought, while I sat beside him, curious to learn what this new quest might be which seemed to tax his powers so sorely, and yet afraid to break in upon the current of his thoughts.\n",
      "\n",
      "\n",
      "Summary of Story 63:\n",
      "I rose and, leaning over him, stared down at the curious inscription, which ran as follows 534 C2 13 127 36 31 4 17 21 41 DOUGLAS 109 293 5 37 BIRLSTONE 26 BIRLSTONE 9 47 171 What do you make of it, Holmes? Led on by some rudimentary aspirations towards right, and encouraged by the judicious stimulation of an occasional tenpound note sent to him by devious methods, he has once or twice given me advance information which has been of valuethat highest value which anticipates and prevents rather than avenges crime. His tall, bony figure gave promise of exceptional physical strength, while his great cranium and deepset, lustrous eyes spoke no less clearly of the keen intelligence which twinkled out from behind his bushy eyebrows. But so aloof is he from general suspicion, so immune from criticism, so admirable in his management and selfeffacement, that for those very words that you have uttered he could hale you to a court and emerge with your years pension as a solatium for his wounded character. Mediocrity knows nothing higher than itself but talent instantly recognizes genius, and MacDonald had talent enough for his profession to enable him to perceive that there was no humiliation in seeking the assistance of one who already stood alone in Europe, both in his gifts and in his experience.\n",
      "\n",
      "\n",
      "Summary of Story 64:\n",
      "Our visitor had no sooner waddled out of the roomno other verb can describe Mrs.  Merrilows method of progressionthan Sherlock Holmes threw himself with fierce energy upon the pile of commonplace books in the corner. He was clearly a professional acrobat, a man of magnificent physique, taken with his huge arms folded across his swollen chest and a smile breaking from under his heavy moustachethe selfsatisfied smile of the man of many conquests. There is the long row of yearbooks which fill a shelf, and there are the dispatchcases filled with documents, a perfect quarry for the student not only of crime but of the social and official scandals of the late Victorian era. When one considers that Mr.  Sherlock Holmes was in active practice for twentythree years, and that during seventeen of these I was allowed to cooperate with him and to keep notes of his doings, it will be clear that I have a mass of material at my command. One could imagine that vile mouth champing and foaming in its rage, and one could conceive those small, vicious eyes darting pure malignancy as they looked forth upon the world.\n",
      "\n",
      "\n",
      "Summary of Story 65:\n",
      "The telegram was a list of names and addresses Lord Harringby, The Dingle Sir George Ffolliott, Oxshott Towers Mr.  Hynes Hynes, J. P. , Purdley Place Mr.  James Baker Williams, Forton Old Hall Mr.  Henderson, High Gable Rev. There was a bustle outside, and Mrs.  Hudson opened the door to usher in two robust and officiallooking individuals, one of whom was well known to us as Inspector Gregson of Scotland Yard, an energetic, gallant, and, within his limitations, a capable officer. It was a cold, dark March evening, with a sharp wind and a fine rain beating upon our faces, a fit setting for the wild common over which our road passed and the tragic goal to which it led us. It is equally certain that this house cannot be more than a mile or two from Oxshott, since Garcia was walking in that direction and hoped, according to my reading of the facts, to be back in Wisteria Lodge in time to avail himself of an alibi, which would only be valid up to one oclock. Please arrange your thoughts and let me know, in their due sequence, exactly what those events are which have sent you out unbrushed and unkempt, with dress boots and waistcoat buttoned awry, in search of advice and assistance.\n",
      "\n",
      "\n",
      "Summary of Story 66:\n",
      "Few men were capable of greater muscular effort, and he was undoubtedly one of the finest boxers of his weight that I have ever seen but he looked upon aimless bodily exertion as a waste of energy, and he seldom bestirred himself save when there was some professional object to be served. She has been married three years, and believes that her position is quite secure, having shown her husband the death certificate of some man whose name she has assumed, when suddenly her whereabouts is discovered by her first husband or, we may suppose, by some unscrupulous woman who has attached herself to the invalid. In the midst of this interview the maid rushed in to say that the master had come home, on which the wife, knowing that he would come straight down to the cottage, hurried the inmates out at the back door, into the grove of firtrees, probably, which was mentioned as standing near. One day in early spring he had so far relaxed as to go for a walk with me in the Park, where the first faint shoots of green were breaking out upon the elms, and the sticky spearheads of the chestnuts were just beginning to burst into their fivefold leaves. My lips were parted to murmur out some sleepy words of surprise or remonstrance at this untimely preparation, when suddenly my halfopened eyes fell upon her face, illuminated by the candlelight, and astonishment held me dumb.\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "import re\n",
    "import nltk\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer\n",
    "from nltk.tokenize import sent_tokenize\n",
    "\n",
    "\n",
    "\n",
    "# Function to clean and prepare story text\n",
    "def clean_story(story):\n",
    "    story = story.split(\"----------\")[0]\n",
    "\n",
    "    # Remove content before 'CHAPTER I' or 'Arthur Conan Doyle'\n",
    "    if \"CHAPTER I\" in story:\n",
    "        story = story.split(\"CHAPTER I\")[1]\n",
    "    elif \"Arthur Conan Doyle\" in story:\n",
    "        story = story.split(\"Arthur Conan Doyle\")[-1]\n",
    "\n",
    "    # Remove special characters and normalize whitespace\n",
    "    story = re.sub(r\"[^\\w\\s.,!?]\", \"\", story)\n",
    "    story = re.sub(r\"\\s+\", \" \", story).strip()\n",
    "\n",
    "    # Remove repetitive phrases\n",
    "    sentences = story.split(\".\")\n",
    "    unique_sentences = list(dict.fromkeys(sentences))  # Remove duplicates\n",
    "    return \". \".join(unique_sentences)\n",
    "\n",
    "# Function to rank sentences based on TF-IDF\n",
    "def rank_sentences(text):\n",
    "    sentences = sent_tokenize(text)  # Split text into sentences\n",
    "    vectorizer = TfidfVectorizer(stop_words=\"english\")\n",
    "    tfidf_matrix = vectorizer.fit_transform(sentences)\n",
    "    \n",
    "    # Calculate scores for each sentence (sum of the TF-IDF scores of the words)\n",
    "    sentence_scores = []\n",
    "    for i, sentence in enumerate(sentences):\n",
    "        score = tfidf_matrix[i].sum()\n",
    "        sentence_scores.append((score, sentence))\n",
    "    \n",
    "    # Sort sentences based on their scores in descending order\n",
    "    ranked_sentences = sorted(sentence_scores, key=lambda x: x[0], reverse=True)\n",
    "    return ranked_sentences\n",
    "\n",
    "# Function to summarize text using extractive summarization\n",
    "def summarize_with_tfidf(story_text, num_sentences=5):\n",
    "    # Clean the story text\n",
    "    story_text = clean_story(story_text)\n",
    "    \n",
    "    # Rank sentences based on their importance\n",
    "    ranked_sentences = rank_sentences(story_text)\n",
    "    \n",
    "    # Select the top 'num_sentences' sentences to form the summary\n",
    "    summary_sentences = [sentence for _, sentence in ranked_sentences[:num_sentences]]\n",
    "    \n",
    "    # Combine the sentences to form the summary\n",
    "    summary = \" \".join(summary_sentences)\n",
    "    \n",
    "    return summary\n",
    "\n",
    "# Example usage with the stories data\n",
    "bad_summaries = {}\n",
    "for story_id, story_text in stories.items():\n",
    "    summary = summarize_with_tfidf(story_text)\n",
    "    bad_summaries[story_id] = summary\n",
    "\n",
    "# Display summaries\n",
    "for story_id, summary in bad_summaries.items():\n",
    "    print(f\"Summary of Story {story_id}:\")\n",
    "    print(summary)\n",
    "    print(\"\\n\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Seq2Seq Model "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Take bad_summaries and apply seq2seq model using an Encoder-Decoder LSTM architecture ???"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**What is a Seq2Seq Model?**\n",
    "- A seq2seq model aims to map a fixed length input with a fixed length output even when their length differs.\n",
    "- As an example translating the English phrase \"Good Afternoon\" to the Greek phrase \"Καλησπέρα\".\n",
    "- In our case, the entire story and the summary have different length as the one is significally shorter than the other. \n",
    "\n",
    "**What is Encoder-Decoder LSTM?**\n",
    "- A recurrent neural network designed to address sequence-to-sequence problems, that has proven very effective.\n",
    "- This architecture is comprised of two models: \n",
    "    - one for reading the input sequence and encoding it into a fixed-length vector\n",
    "    - a second for decoding the fixed-length vector and outputting the predicted sequence. \n",
    "- The use of the models in concert gives the architecture its name of Encoder-Decoder LSTM designed specifically for seq2seq problems.\n",
    "\n",
    "--- \n",
    "\n",
    "https://machinelearningmastery.com/encoder-decoder-long-short-term-memory-networks/\n",
    "\n",
    "https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346\n",
    "\n",
    "https://www.geeksforgeeks.org/seq2seq-model-in-machine-learning/\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
